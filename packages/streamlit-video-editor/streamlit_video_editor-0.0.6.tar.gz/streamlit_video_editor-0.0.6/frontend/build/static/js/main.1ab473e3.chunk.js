(this["webpackJsonpstreamlit-video-timeline"]=this["webpackJsonpstreamlit-video-timeline"]||[]).push([[0],{15:function(e,t,r){},16:function(e,t,r){"use strict";r.r(t);var n=r(1),a=r.n(n),c=r(5),o=r.n(c),s=r(4),l=r(0);var i=Object(s.b)((e=>{let{args:t,theme:r}=e;const a=Object(n.useRef)(!1),c=Object(n.useRef)(null),o=r||{base:"light",primaryColor:"#000",backgroundColor:"#fff",secondaryBackgroundColor:"#f0f0f0",textColor:"#000",font:"sans-serif"},i=Object(n.useRef)(null),d=Object(n.useRef)(null),[u,m]=Object(n.useState)(!1),[b,j]=Object(n.useState)(0),[h,f]=Object(n.useState)(0),[v,O]=Object(n.useState)(0),[x,g]=Object(n.useState)([]),p=Object(n.useRef)(null),A=Object(n.useRef)(null);Object(n.useEffect)((()=>{s.a.setComponentReady();const e=i.current;if(e)return e.addEventListener("loadedmetadata",(()=>{O(e.duration),E(e)})),()=>{p.current&&p.current.close(),e.removeEventListener("loadedmetadata",(()=>{}))}}),[]);const C=e=>{const t=Math.floor(e/60),r=Math.floor(e%60);return`${t}:${r<10?"0"+r:r}`},y=e=>t=>{a.current=!0,c.current=e,document.addEventListener("mousemove",k),document.addEventListener("mouseup",w)},k=e=>{if(!a.current||!d.current||!c.current)return;const t=d.current.getBoundingClientRect(),r=t.width,n=t.left;let o=(e.clientX-n)/r;o=Math.max(0,Math.min(1,o));const s=o*v;"start"===c.current?s<h&&(j(s),i.current&&(i.current.currentTime=s)):s>b&&(f(s),i.current&&(i.current.currentTime=s))},w=()=>{a.current=!1,c.current=null,document.removeEventListener("mousemove",k),document.removeEventListener("mouseup",w)},N=e=>()=>{i.current&&(i.current.currentTime=e)},E=e=>{const t=new AudioContext,r=t.createAnalyser();r.fftSize=256;const n=r.frequencyBinCount,a=new Uint8Array(n);t.createMediaElementSource(e).connect(r),r.connect(t.destination),p.current=t,A.current=r;const c=()=>{A.current&&(A.current.getByteFrequencyData(a),g(Array.from(a)),requestAnimationFrame(c))};c()};return Object(l.jsx)("div",{style:{fontFamily:o.font,color:o.textColor,backgroundColor:o.backgroundColor,padding:"10px"},children:Object(l.jsxs)("div",{className:"container",children:[Object(l.jsxs)("video",{ref:i,controls:!0,style:{width:"100%",maxWidth:"100%"},onError:e=>console.error("Video loading error:",e),children:[Object(l.jsx)("source",{src:t.video_url,type:"video/mp4"}),"Your browser does not support the video tag."]}),Object(l.jsxs)("div",{className:"timeline-wrapper",ref:d,children:[Object(l.jsxs)("div",{className:"timeline-labels",children:[Object(l.jsx)("div",{className:"timeline-label",style:{paddingBottom:"10px",paddingTop:"10px"},children:"VIDEO"}),Object(l.jsx)("div",{className:"timeline-label",children:"AUDIO"})]}),Object(l.jsxs)("div",{className:"timeline-container",children:[Object(l.jsx)("div",{className:"video-track",children:Object(l.jsx)("div",{className:"frame-thumbnails",children:t.frame_data&&t.frame_data.length>0?t.frame_data.map(((e,r)=>Object(l.jsx)("div",{className:"frame-thumbnail",style:{backgroundImage:`url("${e}")`,width:100/t.frame_data.length+"%"}},r))):Array.from({length:10}).map(((e,t)=>Object(l.jsx)("div",{className:"frame-thumbnail",style:{backgroundImage:'url("data:image/gif;base64,R0lGODlhAQABAIAAAP///wAAACH5BAEAAAAALAAAAAABAAEAAAICRAEAOw==")',width:"10%"}},t)))})}),Object(l.jsx)("div",{className:"audio-track",children:Object(l.jsx)("div",{className:"audio-waveform",children:t.waveform_data&&t.waveform_data.length>0?t.waveform_data.map(((e,t)=>{const r=100*Math.max(e,.2);return Object(l.jsx)("div",{className:"waveform-bar",style:{height:`${r}%`,backgroundColor:o.primaryColor||"rgba(255, 75, 75, 0.8)"}},t)})):Array.from({length:100}).map(((e,t)=>{const r=20+15*Math.sin(t*Math.PI/10);return Object(l.jsx)("div",{className:"waveform-bar",style:{height:`${r}%`,backgroundColor:o.primaryColor||"rgba(255, 75, 75, 0.8)",flexBasis:"1%",minWidth:0}},t)}))})}),u&&Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("div",{className:"crop-marker",style:{left:b/v*100+"%",cursor:"ew-resize"},onMouseDown:y("start"),onDoubleClick:N(b),children:Object(l.jsx)("div",{className:"crop-label",children:C(b)})}),Object(l.jsx)("div",{className:"crop-marker",style:{left:h/v*100+"%",cursor:"ew-resize"},onMouseDown:y("end"),onDoubleClick:N(h),children:Object(l.jsx)("div",{className:"crop-label",children:C(h)})})]})]})]}),Object(l.jsx)("div",{className:"button-container",children:u?Object(l.jsxs)(l.Fragment,{children:[Object(l.jsx)("button",{className:"btn",onClick:()=>{s.a.setComponentValue({start:b,end:h,shouldRefreshTaskList:!0}),m(!1)},style:{backgroundColor:o.primaryColor},children:"Aplicar Corte"}),Object(l.jsx)("button",{className:"btn",onClick:()=>m(!1),style:{backgroundColor:o.primaryColor},children:"Cancelar"})]}):Object(l.jsx)("button",{className:"btn",onClick:()=>{u||(j(.1*v),f(.9*v)),m(!u)},style:{backgroundColor:o.primaryColor},children:"Modo de Corte"})})]})})}));r(15);o.a.render(Object(l.jsx)(a.a.StrictMode,{children:Object(l.jsx)(i,{})}),document.getElementById("root"))}},[[16,1,2]]]);