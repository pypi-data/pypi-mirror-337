import{g as Be,p as Qe,h as Ze,aj as xe,B as k,H as et,I as tt,ak as at,N as lt,aS as it,aO as ot,Q,R as c,S as n,D as re,a0 as f,az as K,a4 as se,bs as _e,x as T,c as j,bK as Y,as as X,U as u,a9 as p,Z as g,V as st,bJ as $e,bC as ne,ao as B,ab as v,am as W,aa as nt,a5 as F,an as P,W as R,aq as rt,b7 as q,bL as ut,b8 as mt,bM as Ae,bD as Ce,bG as Te,bN as ue,bO as Fe,aL as dt,aK as ct,a7 as pt,bg as ft,bu as vt,bv as z,X as yt,a2 as $,ar as ht,by as bt,d as kt,b as ie,w as U,o as wt,P as he,bP as gt,aY as G,Y as It,bo as St,G as be,$ as ke,br as oe,bF as Bt,bq as we}from"./index-CcCHt9di.js";import{M as Ve}from"./MediaItemThumb-Dg0gTiNC.js";import{B as De,L as _t}from"./ListItem-Ci1hjJki.js";import{V as Oe}from"./VCheckbox-C-VhILeP.js";import{a as J}from"./VBtn-DAIDoEvo.js";import{_ as me}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as $t,P as At}from"./PanelviewItemCompact-Yn3hafOK.js";import{V as Ct}from"./VSpacer-N9UJbCdj.js";import{C as Tt}from"./Container-BwRDgp4H.js";import{T as Ft}from"./Toolbar-CsiGXKRm.js";import{V as Vt}from"./VTextField-NhYcmyTq.js";import{a as Dt,V as Ot}from"./VInfiniteScroll-C8xpj0RM.js";import{V as ge,a as Ie}from"./VRow-yOQIyFQr.js";import{V as Lt}from"./VVirtualScroll-CQFKQKaZ.js";import{V as Se}from"./VAlert-D8fBawKG.js";const Le=Symbol.for("vuetify:v-item-group"),Pt=Qe({...lt(),...at({selectedClass:"v-item--selected"}),...tt(),...et()},"VItemGroup"),Pe=Be()({name:"VItemGroup",props:Pt(),emits:{"update:modelValue":A=>!0},setup(A,l){let{slots:b}=l;const{themeClasses:I}=Ze(A),{isSelected:i,select:w,next:C,prev:V,selected:a}=xe(A,Le);return()=>k(A.tag,{class:["v-item-group",I.value,A.class],style:A.style},{default:()=>{var _;return[(_=b.default)==null?void 0:_.call(b,{isSelected:i,select:w,next:C,prev:V,selected:a.value})]}})}}),M=Be()({name:"VItem",props:it(),emits:{"group:selected":A=>!0},setup(A,l){let{slots:b}=l;const{isSelected:I,select:i,toggle:w,selectedClass:C,value:V,disabled:a}=ot(A,Le);return()=>{var _;return(_=b.default)==null?void 0:_.call(b,{isSelected:I.value,selectedClass:C.value,select:i,toggle:w,value:V.value,disabled:a.value})}}}),Me=Q({__name:"FavoriteButton",props:{item:{}},setup(A){const l=A;return(b,I)=>{var i;return n(),c(De,re(l,{variant:"list",icon:(i=b.item)!=null&&i.favorite?"mdi-heart":"mdi-heart-outline",title:b.$t("tooltip.favorite"),onClick:[I[0]||(I[0]=w=>f(se).toggleFavorite(b.item)),I[1]||(I[1]=K(()=>{},["prevent"])),I[2]||(I[2]=K(()=>{},["stop"]))]}),null,16,["icon","title"])}}}),Mt={key:0,class:"media-thumb listitem-media-thumb"},Et={key:1,class:"media-thumb listitem-media-thumb"},Kt={key:0},Rt={key:1},Yt={key:0},Nt={key:0,class:"line-clamp-1"},Xt={key:1},zt={key:0},Gt={key:1},Ht={key:2},Ut={key:3},jt={key:4},Wt={key:5},qt={key:6},Jt={key:7},Qt={key:4},Zt={key:5},xt={class:"text-caption",style:{"padding-right":"10px","padding-left":"10px"}},ea=Q({__name:"ListviewItem",props:{item:{},showTrackNumber:{type:Boolean,default:!0},showDiscNumber:{type:Boolean,default:!0},showPosition:{type:Boolean,default:!0},showProvider:{type:Boolean,default:!0},showAlbum:{type:Boolean,default:!0},showMenu:{type:Boolean,default:!0},showFavorite:{type:Boolean,default:!1},showDuration:{type:Boolean,default:!0},isSelected:{type:Boolean},isDisabled:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},showCheckboxes:{type:Boolean,default:!1},showDetails:{type:Boolean},parentItem:{default:void 0}},emits:["select"],setup(A,{emit:l}){const{t:b}=_e(),I=T(!1),i=A,w=j(()=>{if(!("provider_mappings"in i.item))return"";for(const e of i.item.provider_mappings)if(e.audio_format&&e.audio_format.content_type!=null&&[Y.DSF,Y.FLAC,Y.AIFF,Y.WAV].includes(e.audio_format.content_type)&&(e.audio_format.sample_rate>48e3||e.audio_format.bit_depth>16))return`${e.audio_format.sample_rate/1e3}kHz ${e.audio_format.bit_depth} bits`;return""}),C=l,V=function(e){const h="clientX"in e?e.clientX:e.touches[0].clientX,S="clientY"in e?e.clientY:e.touches[0].clientY;ue(i.item,h,S,i.parentItem)},a=function(e){i.showCheckboxes||Fe(i.item,e.clientX,e.clientY,i.parentItem)},_=function(e){i.showCheckboxes||Te(i.item,e.clientX,e.clientY,i.parentItem)};return(e,h)=>(n(),c(_t,{link:"","show-menu-btn":e.showMenu,class:X({unavailable:!e.isAvailable}),onClick:K(a,["stop"]),onMenu:K(V,["stop"])},{prepend:u(()=>[e.showCheckboxes?(n(),g("div",Mt,[k(Oe,{"model-value":e.isSelected,onClick:h[0]||(h[0]=K(()=>{},["stop"])),"onUpdate:modelValue":h[1]||(h[1]=S=>{S!=null&&C("select",e.item,S)})},null,8,["model-value"])])):(n(),g("div",Et,[k(Ve,{size:"50",item:e.isAvailable?e.item:void 0,class:X({dimmed:I.value})},null,8,["item","class"])])),!e.showCheckboxes&&e.item.is_playable?(n(),c(J,{key:2,class:X({hidden:!I.value}),icon:"mdi-play",color:"primary",fab:"",size:"small",style:{position:"absolute",left:"12px",bottom:"12px"},onClick:K(_,["stop"]),onMouseenter:h[2]||(h[2]=S=>I.value=!0),onMouseleave:h[3]||(h[3]=S=>I.value=!1)},null,8,["class"])):p("",!0)]),title:u(()=>[e.item.media_type==f(F).FOLDER?(n(),g("span",Kt,[R("span",null,v(f(Ae)(e.item,f(b))),1)])):(n(),g("span",Rt,[B(v(e.item.name)+" ",1),"version"in e.item&&e.item.version?(n(),g("span",Yt,"("+v(e.item.version)+")",1)):p("",!0)])),e.item&&e.item.metadata?(n(),c(f(ne),{key:2,location:"bottom"},{activator:u(({props:S})=>[f(Ce)(e.item.metadata.explicit||!1)?(n(),c(P,re({key:0},S,{icon:"mdi-alpha-e-box",width:"35"}),null,16)):p("",!0)]),default:u(()=>[R("span",null,v(e.$t("tooltip.explicit")),1)]),_:1})):p("",!0)]),subtitle:u(()=>{var S;return[e.item.media_type==f(F).TRACK&&"provider_mappings"in e.item?(n(),g("div",Nt,[k(Pe,null,{default:u(()=>["artists"in e.item?(n(),c(M,{key:0},{default:u(()=>[B(v(f(q)(e.item.artists,2)),1)]),_:1})):p("",!0),e.showAlbum&&"album"in e.item&&e.item.album?(n(),c(M,{key:1},{default:u(()=>[B(" • "+v(e.item.album.name),1)]),_:1})):p("",!0),e.showDiscNumber&&"disc_number"in e.item&&e.item.disc_number?(n(),c(M,{key:2},{default:u(()=>[k(P,{style:{"margin-left":"5px"},icon:"md:album"}),B(" "+v(e.item.disc_number),1)]),_:1})):p("",!0),e.showTrackNumber&&"track_number"in e.item&&e.item.track_number?(n(),c(M,{key:3},{default:u(()=>[k(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),B(" "+v(e.item.track_number),1)]),_:1})):e.showPosition&&"position"in e.item&&e.item.position?(n(),c(M,{key:4},{default:u(()=>[k(P,{style:{"margin-left":"5px"},icon:"mdi-music-circle-outline"}),B(" "+v(e.item.position),1)]),_:1})):p("",!0)]),_:1})])):e.item.media_type==f(F).ALBUM&&"year"in e.item?(n(),g("div",Xt,[e.item.album_type!=f(ut).UNKNOWN?(n(),g("span",zt,v(e.$t("album_type."+e.item.album_type))+" • ",1)):p("",!0),R("span",null,v(f(q)(e.item.artists)),1),e.item.year?(n(),g("span",Gt," • "+v(e.item.year),1)):p("",!0)])):"artists"in e.item&&e.item.artists?(n(),g("div",Ht,v(f(q)(e.item.artists)),1)):"owner"in e.item&&e.item.owner?(n(),g("div",Ut,v(e.item.owner),1)):"authors"in e.item&&e.item.authors?(n(),g("div",jt,v(e.item.authors.join(" / ")),1)):"publisher"in e.item&&e.item.publisher?(n(),g("div",Wt,v(e.item.publisher),1)):"metadata"in e.item&&((S=e.item.metadata)!=null&&S.description)&&[f(F).RADIO,f(F).PLAYLIST,f(F).FOLDER].includes(e.item.media_type)?(n(),g("div",qt,v(f(mt)(e.item.metadata.description,150)),1)):"media_type"in e.item&&!e.item.provider_mappings?(n(),g("div",Jt,v(e.$t(e.item.media_type)),1)):p("",!0)]}),append:u(()=>[w.value?(n(),c(st,{key:0,src:f($e),width:"30",class:X(e.$vuetify.theme.current.dark?"hiresicondark":"hiresicon")},{default:u(()=>[k(f(ne),{activator:"parent",location:"bottom"},{default:u(()=>[B(v(w.value),1)]),_:1})]),_:1},8,["src","class"])):p("",!0),f(W)("bp2")&&e.showProvider?(n(),c(nt,{key:1,domain:e.item.media_type==f(F).PLAYLIST?e.item.provider_mappings[0].provider_domain:e.item.provider,size:24},null,8,["domain"])):p("",!0),"fully_played"in e.item&&e.item.fully_played?(n(),c(P,{key:2,title:e.$t("item_fully_played")},{default:u(()=>h[4]||(h[4]=[B("mdi-check")])),_:1},8,["title"])):"resume_position_ms"in e.item&&e.item.resume_position_ms?(n(),c(P,{key:3,title:e.$t("item_in_progress")},{default:u(()=>h[5]||(h[5]=[B("mdi-clock-fast")])),_:1},8,["title"])):p("",!0),f(W)("bp3")&&"favorite"in e.item&&e.showFavorite&&!e.$vuetify.display.mobile?(n(),g("div",Qt,[k(Me,{item:e.item},null,8,["item"])])):p("",!0),e.showDuration&&"duration"in e.item&&e.item.duration&&f(W)("bp0")?(n(),g("div",Zt,[R("div",null,[R("span",xt,v(f(rt)(e.item.duration)),1)])])):p("",!0)]),_:1},8,["show-menu-btn","class"]))}}),ta=me(ea,[["__scopeId","data-v-fde2a7b4"]]),aa={key:0},la={key:1},ia={key:2},oa=["src"],sa={key:0},na=Q({__name:"PanelviewItem",props:{item:{},size:{default:200},isSelected:{type:Boolean},showCheckboxes:{type:Boolean,default:!1},showMediaType:{type:Boolean,default:!1},showActions:{type:Boolean,default:!1},isAvailable:{type:Boolean,default:!0},parentItem:{default:void 0}},emits:["select"],setup(A,{emit:l}){const b=A,I=j(()=>{for(const a of b.item.provider_mappings)if(a.audio_format&&a.audio_format.content_type!=null&&[Y.DSF,Y.FLAC,Y.AIFF,Y.WAV].includes(a.audio_format.content_type)&&(a.audio_format.sample_rate>48e3||a.audio_format.bit_depth>16))return`${a.audio_format.sample_rate/1e3}kHz ${a.audio_format.bit_depth} bits`;return""}),i=l,w=function(a){if(b.showCheckboxes)return;const _="clientX"in a?a.clientX:a.touches[0].clientX,e="clientY"in a?a.clientY:a.touches[0].clientY;ue(b.item,_,e,b.parentItem)},C=function(a){if(b.showCheckboxes){i("select",b.item,!b.isSelected);return}Fe(b.item,a.clientX,a.clientY,b.parentItem)},V=function(a){b.showCheckboxes||Te(b.item,a.clientX,a.clientY,b.parentItem)};return(a,_)=>{const e=dt("hold");return n(),c($t,null,{default:u(({isHovering:h,props:S})=>[ct((n(),c(pt,re(S,{tile:"",hover:"",class:["panel-item",{unavailable:!a.isAvailable}],onClick:C,onContextmenu:K(w,["right","prevent"])}),{default:u(()=>[a.showCheckboxes?(n(),c(ft,{key:0,"model-value":a.showCheckboxes,contained:"",scrim:a.isSelected?a.$vuetify.theme.current.dark?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)":"#ffffff00"},{default:u(()=>[k(Oe,{class:"panel-item-checkbox",ripple:!1,"model-value":a.isSelected},null,8,["model-value"])]),_:1},8,["model-value","scrim"])):p("",!0),k(Ve,{item:a.isAvailable?a.item:void 0,style:{height:"auto"}},null,8,["item"]),k(yt,{variant:"text",slim:"",tile:"",density:"compact",class:"panel-item-details"},{default:u(()=>[k(vt,null,{default:u(()=>[a.item.media_type==f(F).FOLDER?(n(),g("span",aa,[R("span",null,v(f(Ae)(a.item,a.$t)),1)])):(n(),g("span",la,v(a.item.name),1)),"version"in a.item&&a.item.version?(n(),g("span",ia," - "+v(a.item.version),1)):p("",!0)]),_:1}),"artists"in a.item&&a.item.artists?(n(),c(z,{key:0,class:"line-clamp-1"},{default:u(()=>[B(v(f(q)(a.item.artists,1)),1)]),_:1})):p("",!0),"authors"in a.item&&a.item.authors?(n(),c(z,{key:1,class:"line-clamp-1"},{default:u(()=>[B(v(a.item.authors.join(" / ")),1)]),_:1})):"publisher"in a.item&&a.item.publisher?(n(),c(z,{key:2,class:"line-clamp-1"},{default:u(()=>[B(v(a.item.publisher),1)]),_:1})):"owner"in a.item&&a.item.owner?(n(),c(z,{key:3,class:"line-clamp-1"},{default:u(()=>[B(v(a.item.owner),1)]),_:1})):a.showMediaType?(n(),c(z,{key:4,class:"line-clamp-1"},{default:u(()=>[B(v(a.$t(a.item.media_type)),1)]),_:1})):(n(),c(z,{key:5,class:"line-clamp-1"}))]),_:1}),(h||f($).isTouchscreen)&&a.isAvailable&&a.item.is_playable?(n(),c(J,{key:1,icon:"mdi-play",color:"primary",fab:"",style:ht(`position: absolute; right: 15px; bottom: ${a.showActions?90:35}px; opacity: 0.8`),onClick:K(V,["stop"])},null,8,["style"])):p("",!0),a.showActions?(n(),c(bt,{key:2,class:"panel-item-actions"},{default:u(()=>[k(Pe,{style:{padding:"0"}},{default:u(()=>[f(Ce)(a.item.metadata.explicit||!1)?(n(),c(M,{key:0},{default:u(()=>[k(P,{size:"30",icon:"mdi-alpha-e-box"})]),_:1})):p("",!0),I.value?(n(),c(M,{key:1},{default:u(()=>[k(P,{class:X(a.$vuetify.theme.current.dark?"hiresicon":"hiresiconinverted")},{default:u(()=>[R("img",{src:f($e),width:"30"},null,8,oa),k(ne,{activator:"parent",location:"bottom"},{default:u(()=>[B(v(I.value),1)]),_:1})]),_:1},8,["class"])]),_:1})):p("",!0),"track_number"in a.item&&a.item.track_number?(n(),c(M,{key:2},{default:u(()=>[k(P,{size:"small",icon:"mdi-music-circle-outline"}),a.item.disc_number?(n(),g("span",sa,v(a.item.disc_number)+"/",1)):p("",!0),B(v(a.item.track_number),1)]),_:1})):"position"in a.item&&a.item.position?(n(),c(M,{key:3},{default:u(()=>[k(P,{size:"small",icon:"mdi-music-circle-outline"}),B(" "+v(a.item.position),1)]),_:1})):p("",!0),f(W)("bp3")?(n(),c(M,{key:4},{default:u(()=>[k(Me,{item:a.item},null,8,["item"])]),_:1})):p("",!0)]),_:1}),k(Ct),h||a.$vuetify.display.mobile?(n(),c(De,{key:0,variant:"list",icon:"mdi-dots-vertical",style:{"padding-right":"0","margin-right":"-5px"},onClick:K(w,["stop"])})):p("",!0)]),_:2},1024)):p("",!0)]),_:2},1040,["class"])),[[e,w]])]),_:1})}}}),ra=me(na,[["__scopeId","data-v-9d8473a1"]]),ua={key:0},ma={key:2},da=Q({__name:"ItemsListing",props:{itemtype:{},sortKeys:{default:()=>["name","sort_name"]},showTrackNumber:{type:Boolean,default:!0},showProvider:{type:Boolean,default:Object.keys(se.providers).length>1},showAlbum:{type:Boolean,default:!0},showFavoritesOnlyFilter:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!0},parentItem:{default:void 0},showAlbumArtistsOnlyFilter:{type:Boolean},showSearchButton:{type:Boolean,default:void 0},showRefreshButton:{type:Boolean,default:void 0},showSelectButton:{type:Boolean,default:void 0},showAlbumTypeFilter:{type:Boolean,default:void 0},updateAvailable:{type:Boolean},title:{default:void 0},hideOnEmpty:{type:Boolean,default:!1},showLibraryOnlyFilter:{type:Boolean,default:!1},allowCollapse:{type:Boolean,default:!1},allowKeyHooks:{type:Boolean,default:!1},extraMenuItems:{default:void 0},loadPagedData:{type:Function,default:void 0},loadItems:{type:Function,default:void 0},limit:{default:50},total:{default:void 0},infiniteScroll:{type:Boolean,default:!0},path:{default:void 0},icon:{default:void 0},restoreState:{type:Boolean,default:!1}},setup(A){const l=A,b=Bt(),{t:I}=_e(),i=T({offset:0,limit:50,sortBy:"name",search:"",libraryOnly:!1}),w=T("list"),C=T(!1),V=T(!1),a=T([]),_=T([]),e=T(!1),h=T([]),S=T(!1),L=T(!1),N=T(!0),E=T(!1),H=T(!1),Z=T(!1),de=function(){i.value.search="",C.value=!1},x=function(){he(()=>{var t;(t=document.getElementById("searchInput"))==null||t.focus()})},Ee=function(){C.value?de():(C.value=!0,x())},ee=function(){N.value=!N.value;const t=`${l.path}.${l.itemtype}`;localStorage.setItem(`expand.${t}`,N.value.toString())},te=function(t){w.value=t;const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`viewMode.${s}`,t)},Ke=function(){i.value.favoritesOnly=!i.value.favoritesOnly;const t=i.value.favoritesOnly?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`favoriteFilter.${s}`,t),O(void 0,void 0,!0)},Re=function(){i.value.libraryOnly=!i.value.libraryOnly;const t=i.value.libraryOnly?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`libraryFilter.${s}`,t),O(!0,void 0,!0)},Ye=function(){i.value.albumArtistsFilter=!i.value.albumArtistsFilter;const t=i.value.albumArtistsFilter?"true":"false",s=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumArtistsFilter.${s}`,t),O(void 0,void 0,!0)},ae=function(t){return h.value.includes(t)},le=function(t,s){if(s)h.value.includes(t)||h.value.push(t);else for(let o=0;o<h.value.length;o++)h.value[o]===t&&h.value.splice(o,1)},Ne=function(){L.value&&(h.value=[]),L.value=!L.value},Xe=function(){O(!0,!0)},ze=function(){i.value.search="",C.value=!1,O(void 0,void 0,!0)},Ge=function(t){t!==void 0&&(i.value.sortBy=t);const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`sortBy.${s}`,i.value.sortBy),O(void 0,void 0,!0)},He=function(t){var o,m;(o=i.value.albumType)!=null&&o.includes(t)?i.value.albumType=(m=i.value.albumType)==null?void 0:m.filter(y=>y!==t):(i.value.albumType=i.value.albumType||[],i.value.albumType.push(t));const s=`${l.path}.${l.itemtype}`;localStorage.setItem(`albumType.${s}`,i.value.albumType.join(",")),O(void 0,void 0,!0)},Ue=function(){$.globalSearchTerm=i.value.search,l.itemtype=="artists"?$.globalSearchType=F.ARTIST:l.itemtype=="albums"?$.globalSearchType=F.ALBUM:l.itemtype=="tracks"?$.globalSearchType=F.TRACK:l.itemtype=="playlists"?$.globalSearchType=F.PLAYLIST:l.itemtype=="audiobooks"?$.globalSearchType=F.AUDIOBOOK:l.itemtype=="podcasts"?$.globalSearchType=F.PODCAST:l.itemtype=="radios"&&($.globalSearchType=F.RADIO),b.push({name:"search"})},ce=async function({done:t}){if(E.value){t("empty");return}await O(void 0,void 0,void 0,i.value.offset+l.limit),t("ok")},je=async function(){for(;!E.value;)await ce({done:function(){}})},pe=j(()=>{var t=!1;return i.value.search&&i.value.search.length!==0&&(t=!0),t}),fe=j(()=>C.value&&N.value);kt(()=>{fe.value||(V.value=!1)});const We=j(()=>{var s,o;if(l.allowCollapse===!0&&!N.value)return[{label:"tooltip.collapse_expand",icon:"mdi-chevron-down",action:ee,overflowAllowed:!1}];const t=[];return l.showSelectButton!==!1&&(L.value&&t.push({label:"tooltip.select_all",icon:"mdi-select-all",action:ye}),t.push({label:"tooltip.select_items",icon:L.value?"mdi-checkbox-multiple-outline":"mdi-checkbox-multiple-blank-outline",action:Ne,active:L.value})),l.showLibraryOnlyFilter===!0&&t.push({label:"tooltip.filter_library",icon:"mdi-bookshelf",action:Re,active:i.value.libraryOnly}),l.showFavoritesOnlyFilter===!0&&t.push({label:"tooltip.filter_favorites",icon:i.value.favoritesOnly?"mdi-heart":"mdi-heart-outline",action:Ke,active:i.value.favoritesOnly}),l.showAlbumArtistsOnlyFilter===!0&&t.push({label:"tooltip.album_artist_filter",icon:i.value.albumArtistsFilter?"mdi-account-music":"mdi-account-music-outline",action:Ye,active:i.value.albumArtistsFilter}),l.showAlbumTypeFilter&&t.push({label:"tooltip.album_type",icon:"mdi-album",disabled:e.value,subItems:["album","single","ep","compilation","unknown"].map(m=>{var y;return{label:`album_type.${m}`,selected:(y=i.value.albumType)==null?void 0:y.includes(m),action:()=>{He(m)}}})}),(l.showRefreshButton!==!1||S.value)&&t.push({label:S.value?"tooltip.refresh_new_content":"tooltip.refresh",icon:"mdi-refresh",action:Xe,active:S.value,disabled:e.value}),(s=l.sortKeys)!=null&&s.length&&t.push({label:"tooltip.sort_options",icon:"mdi-sort",disabled:l.sortKeys.length<=1||e.value,subItems:l.sortKeys.map(m=>({label:`sort.${m}`,selected:i.value.sortBy==m,action:()=>{Ge(m)}}))}),l.showSearchButton!==!1&&t.push({label:pe.value?"tooltip.search_filter_active":"tooltip.search",icon:"mdi-magnify",action:Ee,active:pe.value,disabled:e.value}),t.push({label:"tooltip.toggle_view_mode",icon:w.value=="list"?"mdi-view-list":"mdi-grid",subItems:[{label:"view.list",icon:"mdi-view-list",selected:w.value=="list",action:()=>{te("list")}},{label:"view.panel",icon:"mdi-grid",selected:w.value=="panel",action:()=>{te("panel")}},{label:"view.panel_compact",icon:"mdi-grid",selected:w.value=="panel_compact",action:()=>{te("panel_compact")}}]}),(o=l.extraMenuItems)!=null&&o.length&&t.push(...l.extraMenuItems),l.allowCollapse===!0&&t.push({label:"tooltip.collapse_expand",icon:"mdi-chevron-up",action:ee}),t}),O=async function(t=!1,s=!1,o=!1,m=0){if(!e.value){if(e.value=!0,o&&l.loadPagedData!=null&&(t=!0),(t||s)&&(m=0,E.value&&(Z.value=!0),E.value=!1,H.value=!1,S.value=!1),i.value.offset=m,i.value.limit=l.limit,i.value.refresh=s,l.loadPagedData!=null){const y=await l.loadPagedData(i.value);i.value.offset?a.value.push(...y):a.value=y,Math.abs(y.length-l.limit)>10&&(E.value=!0)}else if(l.loadItems!=null){(!H.value||s)&&(_.value=await l.loadItems(i.value),H.value=!0);const y=Je(_.value,i.value);i.value.offset?a.value.push(...y):a.value=y,E.value=y.length<l.limit}i.value.refresh=!1,e.value=!1,Z.value=!1}},qe=async function(){const t=`${l.path}.${l.itemtype}`,s=localStorage.getItem(`viewMode.${t}`);s&&s!=="null"?w.value=s:l.itemtype=="artists"||l.itemtype=="albums"?w.value="panel":w.value="list";const o=localStorage.getItem(`sortBy.${t}`);if(o&&o!=="null"&&l.sortKeys.includes(o)?i.value.sortBy=o:i.value.sortBy=l.sortKeys[0],l.showFavoritesOnlyFilter!==!1){const m=localStorage.getItem(`favoriteFilter.${t}`);m&&m=="true"&&(i.value.favoritesOnly=!0)}if(l.showLibraryOnlyFilter!==!1){const m=localStorage.getItem(`libraryFilter.${t}`);m&&m=="true"&&(i.value.libraryOnly=!0)}if(l.showAlbumArtistsOnlyFilter!==!1){const m=localStorage.getItem(`albumArtistsFilter.${t}`);m&&(i.value.albumArtistsFilter=m=="true")}if(l.allowCollapse!==!1){const m=localStorage.getItem(`expand.${t}`);m&&(N.value=m=="true")}if(l.showAlbumTypeFilter===!0){const m=localStorage.getItem(`albumType.${t}`);m&&(i.value.albumType=m.split(","))}if(l.restoreState){let m=`search.${t}`;l.parentItem&&(m+=l.parentItem.item_id);const y=localStorage.getItem(m);y&&y!=="null"&&(i.value.search=y)}},ve=function(t){$.dialogActive||e.value||(t.key==="Escape"&&de(),!V.value&&(t.key==="a"&&(t.ctrlKey||t.metaKey)?(t.preventDefault(),ye()):!V.value&&t.key=="Backspace"?x():!V.value&&t.key.length==1&&(C.value=!0,x())))};l.allowKeyHooks&&(document.addEventListener("keydown",ve),ie(()=>{document.removeEventListener("keydown",ve)})),l.restoreState&&ie(()=>{const t=l.path||l.itemtype,s=document.querySelector("#cont");$.prevState={path:t,scrollPos:(s==null?void 0:s.scrollTop)||0,pagedItems:a.value,allItems:_.value,allItemsReceived:E.value,initialDataReceived:H.value,params:i.value}}),U(()=>i.value.search,t=>{t&&(C.value=!0),O(void 0,void 0,!0);let s=`search.${l.path}.${l.itemtype}`;l.parentItem&&(s+=l.parentItem.item_id),localStorage.setItem(s,i.value.search)}),U(()=>l.path,t=>{e.value!=!0&&(a.value=[],_.value=[],O(!0))}),U(()=>l.parentItem,()=>{e.value!=!0&&(_.value=[],S.value=!0)},{deep:!0}),U(()=>l.limit,t=>{i.value.limit=t}),U(()=>l.updateAvailable,t=>{e.value||(S.value=t)},{immediate:!0}),wt(async()=>{var o;qe();const t=l.path||l.itemtype;l.restoreState&&((o=$.prevState)==null?void 0:o.path)==t?(i.value=$.prevState.params,a.value=$.prevState.pagedItems,_.value=$.prevState.allItems,E.value=$.prevState.allItemsReceived,H.value=$.prevState.initialDataReceived,he(()=>{const m=document.getElementById("cont");m&&gt(m,$.prevState.scrollPos,50)}),e.value=!1):O(!0);const s=se.subscribe_multi([G.MEDIA_ITEM_UPDATED,G.MEDIA_ITEM_DELETED,G.MEDIA_ITEM_PLAYED],m=>{if(m.event==G.MEDIA_ITEM_DELETED)a.value=a.value.filter(y=>y.uri!=m.object_id);else if(m.event==G.MEDIA_ITEM_UPDATED){const y=a.value.findIndex(d=>d.uri==m.object_id);y>=0&&(a.value[y]=m.data)}else if(m.event==G.MEDIA_ITEM_PLAYED){const y=a.value.findIndex(d=>d.uri==m.object_id);y>=0&&("fully_played"in a.value[y]&&(a.value[y].fully_played=m.data.fully_played),"resume_position_ms"in a.value[y]&&(a.value[y].resume_position_ms=m.data.seconds_played*1e3))}});ie(s)});const D=function(t,s=!1){return t?"label"in t&&t.label&&t.name?I(t.label,[t.name]):"label"in t&&t.label?I(t.label):s&&"sort_name"in t&&t.sort_name?t.sort_name:t.name:""},Je=function(t,s){var m,y;let o=[];if(s.search){const d=s.search.toLowerCase();for(const r of t)(r.name.toLowerCase().includes(d)||"artist"in r&&((m=r.artist)!=null&&m.name.toLowerCase().includes(d))||"album"in r&&((y=r.album)!=null&&y.name.toLowerCase().includes(d))||"artists"in r&&r.artists&&r.artists.length&&r.artists[0].name.toLowerCase().includes(d))&&o.push(r)}else o=[...t];return s.sortBy=="name"&&o.sort((d,r)=>D(d).localeCompare(D(r),void 0,{numeric:!0})),s.sortBy=="sort_name"&&o.sort((d,r)=>D(d,!0).localeCompare(D(r,!0),void 0,{numeric:!0})),s.sortBy=="name_desc"&&o.sort((d,r)=>D(r).localeCompare(D(d),void 0,{numeric:!0})),s.sortBy=="sort_name_desc"&&o.sort((d,r)=>D(r,!0).localeCompare(D(d,!0),void 0,{numeric:!0})),s.sortBy=="album"&&o.sort((d,r)=>D(d.album).localeCompare(D(r.album),void 0,{numeric:!0})),s.sortBy=="artist"&&o.sort((d,r)=>D(d.artists[0]).localeCompare(D(r.artists[0]))),s.sortBy=="track_number"&&(o.sort((d,r)=>(d.track_number||0)-(r.track_number||0)),o.sort((d,r)=>(d.disc_number||0)-(r.disc_number||0))),s.sortBy=="position"&&o.sort((d,r)=>(d.position||0)-(r.position||0)),s.sortBy=="position_desc"&&o.sort((d,r)=>(r.position||0)-(d.position||0)),s.sortBy=="year"&&o.sort((d,r)=>(d.year||0)-(r.year||0)),s.sortBy=="year_desc"&&o.sort((d,r)=>(r.year||0)-(d.year||0)),s.sortBy=="recent"&&o.sort((d,r)=>(r.timestamp_added||0)-(d.timestamp_added||0)),s.sortBy=="duration"&&o.sort((d,r)=>(d.duration||0)-(r.duration||0)),s.sortBy=="duration_desc"&&o.sort((d,r)=>(r.duration||0)-(d.duration||0)),s.sortBy=="provider"&&o.sort((d,r)=>d.provider.localeCompare(r.provider)),s.favoritesOnly&&(o=o.filter(d=>d.favorite)),s.albumType&&s.albumType.length>0&&(o=o.filter(d=>{var r;return(r=s.albumType)==null?void 0:r.includes(d.album_type)})),o.slice(s.offset,s.offset+s.limit)},ye=async function(){let t=!0;(l.total||_.value.length)>250&&(t=await new Promise(o=>{confirm(I("select_all_confirmation"))?o(!0):o(!1)})),t&&(await je(),h.value=a.value,L.value=!0)};return(t,s)=>t.hideOnEmpty&&a.value.length==0?p("",!0):(n(),g("section",ua,[k(Ft,{icon:t.icon,title:t.title,count:i.value.search?a.value.length:t.total||_.value.length,color:"transparent","menu-items":We.value,onTitleClicked:ee},null,8,["icon","title","count","menu-items"]),k(It),fe.value?(n(),c(Vt,{key:0,id:"searchInput",modelValue:i.value.search,"onUpdate:modelValue":s[0]||(s[0]=o=>i.value.search=o),clearable:"","prepend-inner-icon":"mdi-magnify",label:t.$t("search"),"hide-details":"",variant:"filled",style:{width:"auto","margin-top":"10px"},onFocus:s[1]||(s[1]=o=>V.value=!0),onBlur:s[2]||(s[2]=o=>V.value=!1),"onClick:clear":ze},null,8,["modelValue","label"])):p("",!0),N.value?(n(),c(Tt,{key:1,variant:w.value=="list"?"default":"panel",style:{overflow:"hidden"}},{default:u(()=>[e.value?(n(),c(St,{key:0,color:"accent",height:"4",indeterminate:"",rounded:""})):p("",!0),!Z.value&&!(a.value.length==0&&E.value)?(n(),c(Dt,{key:1,onLoad:ce,mode:t.infiniteScroll?"intersect":"manual","load-more-text":t.$t("load_more_items"),"empty-text":"",style:{overflow:"hidden"}},{default:u(()=>[w.value=="panel"?(n(),c(ge,{key:0},{default:u(()=>[(n(!0),g(be,null,ke(a.value,o=>(n(),c(Ie,{key:o.uri,cols:"12",class:X(`col-${f(we)(t.$vuetify.display.width)}`)},{default:u(()=>[k(ra,{item:o,"is-selected":ae(o),"show-checkboxes":L.value,"show-actions":["tracks","albums"].includes(t.itemtype),"is-available":f(oe)(o),"parent-item":t.parentItem,onSelect:le},null,8,["item","is-selected","show-checkboxes","show-actions","is-available","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),w.value=="panel_compact"?(n(),c(ge,{key:1},{default:u(()=>[(n(!0),g(be,null,ke(a.value,o=>(n(),c(Ie,{key:o.uri,cols:"12",class:X(`col-${f(we)(t.$vuetify.display.width)}`)},{default:u(()=>[k(At,{item:o,"is-selected":ae(o),"show-checkboxes":L.value,"is-available":f(oe)(o),"parent-item":t.parentItem,onSelect:le},null,8,["item","is-selected","show-checkboxes","is-available","parent-item"])]),_:2},1032,["class"]))),128))]),_:1})):p("",!0),w.value=="list"?(n(),c(Lt,{key:2,"item-height":70,height:"100%",items:a.value,style:{height:"100%",overflow:"hidden"}},{default:u(({item:o})=>[k(ta,{item:o,"show-track-number":t.showTrackNumber,"show-disc-number":t.showTrackNumber,"show-duration":t.showDuration,"show-favorite":t.showFavoritesOnlyFilter,"show-menu":o.is_playable,"show-provider":t.showProvider,"show-album":t.showAlbum,"show-checkboxes":L.value,"is-selected":ae(o),"is-available":f(oe)(o),"show-details":t.itemtype.includes("versions"),"parent-item":t.parentItem,onSelect:le},null,8,["item","show-track-number","show-disc-number","show-duration","show-favorite","show-menu","show-provider","show-album","show-checkboxes","is-selected","is-available","show-details","parent-item"])]),_:1},8,["items"])):p("",!0)]),_:1},8,["mode","load-more-text"])):p("",!0),!e.value&&a.value.length==0?(n(),g("div",ma,[!e.value&&a.value.length==0&&(i.value.search||i.value.favoritesOnly)?(n(),c(Se,{key:0,title:t.$t("no_content_filter")},{default:u(()=>[i.value.search?(n(),c(J,{key:0,style:{"margin-top":"15px"},onClick:Ue},{default:u(()=>[B(v(t.$t("try_global_search")),1)]),_:1})):p("",!0)]),_:1},8,["title"])):!e.value&&a.value.length==0?(n(),c(Se,{key:1},{default:u(()=>[B(v(t.$t("no_content")),1)]),_:1})):p("",!0)])):p("",!0),k(Ot,{"model-value":h.value.length>1,timeout:-1,style:{"margin-bottom":"120px"}},{actions:u(()=>[k(J,{color:"primary",variant:"text",onClick:s[3]||(s[3]=o=>f(ue)(h.value,o.clientX,o.clientY,t.parentItem))},{default:u(()=>[B(v(t.$t("actions")),1)]),_:1})]),default:u(()=>[R("span",null,v(t.$t("items_selected",[h.value.length])),1)]),_:1},8,["model-value"])]),_:1},8,["variant"])):p("",!0)]))}}),Aa=me(da,[["__scopeId","data-v-11e83d22"]]);export{Aa as I};
