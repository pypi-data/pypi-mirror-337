(()=>{"use strict";var e=function(e,t,n,o){return new(n||(n=Promise))((function(c,i){function a(e){try{r(o.next(e))}catch(e){i(e)}}function d(e){try{r(o.throw(e))}catch(e){i(e)}}function r(e){var t;e.done?c(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,d)}r((o=o.apply(e,t||[])).next())}))};function t(e){return new URLSearchParams(window.location.search).get(e)||""}function n(){const e=document.getElementById("delete-button"),t=document.querySelectorAll('input[type="checkbox"]:checked');e.disabled=0===t.length}document.addEventListener("DOMContentLoaded",(()=>e(void 0,void 0,void 0,(function*(){const o=t("path");try{const e=yield fetch(`/api/files?path=${encodeURIComponent(o)}`);!function(e,t){const o=document.getElementById("directory-container");if(!o)return;if(o.innerHTML="",o.className="directory-listing",t){const e=document.createElement("a"),n=t.split("/").filter(Boolean);n.pop();const c=n.join("/");e.href=`/?path=${encodeURIComponent(c)}`,e.textContent=".. (up)",e.className="up-link",o.appendChild(e),o.appendChild(document.createElement("br"))}const c=document.createElement("table");c.className="directory-table";const i=document.createElement("tr"),a=document.createElement("th"),d=document.createElement("input");d.type="checkbox",d.addEventListener("change",(()=>{r.forEach((e=>e.checked=d.checked)),n()})),a.appendChild(d),i.appendChild(a),["Name","Type","Size (KB)","Last Modified"].forEach((e=>{const t=document.createElement("th");t.textContent=e,i.appendChild(t)})),c.appendChild(i);const r=[];e.forEach((e=>{const o=document.createElement("tr"),i=document.createElement("td"),a=document.createElement("input");a.type="checkbox",a.dataset.filepath=t?`${t}/${e.name}`:e.name,a.addEventListener("change",n),r.push(a),i.appendChild(a),o.appendChild(i);const d=document.createElement("td"),l=document.createElement("a");if(e.isDir){const n=t?`${t}/${e.name}`:e.name;l.href=`/?path=${encodeURIComponent(n)}`,l.textContent=`[DIR] ${e.name}`,l.className="dir-link"}else{const n=t?`${t}/${e.name}`:e.name;l.href=`/open/${encodeURIComponent(n)}`,l.textContent=e.name,e.name.endsWith(".ipynb")?l.className="notebook-link":l.className="file-link"}d.appendChild(l),o.appendChild(d);const s=document.createElement("td");s.textContent=e.type||"unknown",o.appendChild(s);const p=document.createElement("td");p.textContent=e.size?(e.size/1024).toFixed(2):"-",o.appendChild(p);const h=document.createElement("td"),m=e.lastModified?new Date(1e3*e.lastModified).toLocaleString():"-";h.textContent=m,o.appendChild(h),c.appendChild(o)})),o.appendChild(c)}((yield e.json()).children,o)}catch(e){console.error("Error loading directory:",e)}const c=document.getElementById("delete-button");c&&c.addEventListener("click",(()=>e(void 0,void 0,void 0,(function*(){const e=Array.from(document.querySelectorAll('input[type="checkbox"]:checked')).map((e=>e.dataset.filepath));if(0!==e.length&&confirm(`Are you sure you want to delete ${e.length} files?`))try{if(!(yield fetch("/api/delete_files",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({files:e})})).ok)throw new Error("Failed to delete files");location.reload()}catch(e){console.error("Error deleting files:",e),alert("Error deleting files")}}))))}))));document.addEventListener("DOMContentLoaded",(()=>{return e=void 0,n=void 0,c=function*(){var e;const n=t("path")||"",o=document.getElementById("python-version"),c=document.getElementById("pip-version");if(null===(e=document.getElementById("new-notebook-btn"))||void 0===e||e.addEventListener("click",(()=>{!function(e){var t,n,o,c;t=this,n=void 0,c=function*(){let t=prompt("Enter the name of the new notebook:");if(!t)return;t=t.replace(/\.ipynb$/i,"")+".ipynb";const n=e?`${e}/${t}`:t;try{const e=yield fetch(`/api/notebook/create?path=${encodeURIComponent(n)}`,{method:"POST"});if(e.ok)location.reload();else{const t=yield e.json();alert(`Error: ${t.message||"Failed to create notebook"}`)}}catch(e){console.error("Failed to create notebook:",e),alert("Failed to create notebook. Please try again.")}},new((o=void 0)||(o=Promise))((function(e,i){function a(e){try{r(c.next(e))}catch(e){i(e)}}function d(e){try{r(c.throw(e))}catch(e){i(e)}}function r(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,d)}r((c=c.apply(t,n||[])).next())}))}(n)})),o&&c)try{const e=yield fetch("/api/packages"),t=yield e.json();o.textContent=t.python_version,c.textContent=t.pip_version}catch(e){console.error("Error fetching version info:",e),o.textContent="Python: error",c.textContent="pip: error"}},new((o=void 0)||(o=Promise))((function(t,i){function a(e){try{r(c.next(e))}catch(e){i(e)}}function d(e){try{r(c.throw(e))}catch(e){i(e)}}function r(e){var n;e.done?t(e.value):(n=e.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,d)}r((c=c.apply(e,n||[])).next())}));var e,n,o,c}))})();