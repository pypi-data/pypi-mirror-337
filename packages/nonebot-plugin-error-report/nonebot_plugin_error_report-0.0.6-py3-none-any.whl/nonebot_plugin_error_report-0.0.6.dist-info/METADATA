Metadata-Version: 2.1
Name: nonebot-plugin-error-report
Version: 0.0.6
Summary: åŸºäºnonebotçš„æŠ¥é”™å¤„ç†æ’ä»¶ï¼Œæ”¯æŒå›¾ç‰‡/æ–‡å­—å‘é€ã€æ•°æ®åº“å­˜å‚¨åŠè·¨å¹³å°
Home-page: https://github.com/huanxin996/nonebot_plugin_error_report
Author: huanxin996
Author-email: mc.xiaolang@foxmail.com
Classifier: Programming Language :: Python :: 3
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: nonebot-plugin-alconna<=0.56.2
Requires-Dist: nonebot-plugin-tortoise-orm<=0.1.4
Requires-Dist: nonebot-plugin-userinfo<=0.2.6
Requires-Dist: nonebot-plugin-apscheduler<=0.5.0
Requires-Dist: pillow<=11.1.0
Requires-Dist: aiosmtplib<=4.0.0

<!-- markdownlint-disable MD033 MD036 MD041 -->

<p align="center">
  <a href="https://huanxinbot.com/"><img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_hx-yinying/main/.venv/hx_img.png" width="200" height="200" alt="è¿™é‡Œæ”¾ä¸€å¼ océ¥­ğŸ¤¤"></a>
</p>

<div align="center">

# NoneBot é”™è¯¯ç®¡ç†æ’ä»¶

_âœ¨ æ™ºèƒ½è®°å½•å¹¶å¯è§†åŒ–æœºå™¨äººè¿è¡Œæ—¶çš„é”™è¯¯ä¿¡æ¯ âœ¨_

</div>

> [!note]
> å¦‚æœ‰å»ºè®®æˆ–é”™è¯¯ï¼Œè¯·æäº¤ issueã€‚\
> æœ¬äººä»£ç æ°´å¹³å¾ˆçƒ‚ï¼Œå°†å°±ç€ç”¨ç½¢()

## ğŸ“ æ’ä»¶ä»‹ç»

è¿™æ˜¯ä¸€ä¸ªåŸºäº NoneBot2 çš„é”™è¯¯å¤„ç†æ’ä»¶ï¼Œæä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š

- å®æ—¶æ•è·å¹¶ç»˜åˆ¶é”™è¯¯è¯¦ç»†ä¿¡æ¯ä¸ºå›¾ç‰‡
- æ”¯æŒé”™è¯¯ä¿¡æ¯çš„æŒä¹…åŒ–å­˜å‚¨ä¸ç®¡ç†
- å¤šæ ·åŒ–çš„é”™è¯¯æŸ¥è¯¢ä¸ç»Ÿè®¡åŠŸèƒ½
- æ”¯æŒå¤šå¹³å°é€‚é…

## ğŸ¯ åŠŸèƒ½ç‰¹ç‚¹

- è‡ªåŠ¨å°†é”™è¯¯ä¿¡æ¯è½¬æ¢ä¸ºå›¾ç‰‡å‘é€(å¤±è´¥æ—¶è‡ªåŠ¨åˆ‡æ¢ä¸ºæ–‡æœ¬æ¨¡å¼)
- æ”¯æŒé”™è¯¯ä¿¡æ¯çš„æ•°æ®åº“å­˜å‚¨
- æä¾›ä¸°å¯Œçš„é”™è¯¯ç®¡ç†å‘½ä»¤
- åŸºäº nonebot-plugin-userinfo è·å–ç”¨æˆ·ä¿¡æ¯
- ä½¿ç”¨ nonebot_plugin_alconna æä¾›ä¼˜é›…çš„å‘½ä»¤äº¤äº’

## ğŸ’¿ å®‰è£…æ–¹å¼

```bash
pip install nonebot-plugin-error-manager
```

```bash
nb plugin install nonebot_plugin_error_manager
```

## âš™ï¸ é…ç½®è¯´æ˜

### åŸºç¡€é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|------|--------|-----|
| error_image_quality | int | 30 | é”™è¯¯å›¾ç‰‡æ¸²æŸ“è´¨é‡(1-100) |
| error_image_font | str | None | é”™è¯¯å›¾ç‰‡å­—ä½“æ–‡ä»¶è·¯å¾„ |
| enable_error_report | bool | True | æ˜¯å¦å¯ç”¨é”™è¯¯è®°å½•åŠŸèƒ½ |
| use_orm_database | bool | True | æ˜¯å¦ä½¿ç”¨æ•°æ®åº“å­˜å‚¨(Falseåˆ™ä½¿ç”¨JSONæ–‡ä»¶) |

### é‚®ä»¶é€šçŸ¥é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|------|--------|-----|
| enable_email | bool | False | æ˜¯å¦å¯ç”¨é‚®ä»¶é€šçŸ¥ |
| smtp_host | str | "smtp.qq.com" | SMTPæœåŠ¡å™¨åœ°å€ |
| smtp_port | int | 465 | SMTPæœåŠ¡å™¨ç«¯å£ |
| smtp_ssl | bool | True | æ˜¯å¦ä½¿ç”¨SSLè¿æ¥ |
| smtp_user | str | "" | SMTPç”¨æˆ·å |
| smtp_password | str | "" | SMTPå¯†ç æˆ–æˆæƒç  |
| email_from | str | "" | å‘ä»¶äººé‚®ç®± |
| email_to | list[str] | [] | æ”¶ä»¶äººé‚®ç®±åˆ—è¡¨ |

### å®šæ—¶æŠ¥å‘Šé…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|------|--------|-----|
| enable_scheduled_report | bool | False | æ˜¯å¦å¯ç”¨å®šæ—¶æŠ¥å‘Š |
| report_mode | str | "count" | è§¦å‘æ¨¡å¼: count(ç´¯è®¡è§¦å‘)/time(å®šæ—¶è§¦å‘) |
| report_count | int | 10 | ç´¯è®¡é”™è¯¯è§¦å‘é˜ˆå€¼(countæ¨¡å¼) |
| report_interval | str | "0 0 `*` `*` `*`" | å®šæ—¶å‘é€cronè¡¨è¾¾å¼(timeæ¨¡å¼) |
| clear_after_report | bool | False | å‘é€åæ˜¯å¦æ¸…ç©ºè®°å½• |

### é”™è¯¯è¿‡æ»¤é…ç½®

| é…ç½®é¡¹ | ç±»å‹ | é»˜è®¤å€¼ | è¯´æ˜ |
|-------|------|--------|-----|
| ignored_plugins | list[str] | [] | å¿½ç•¥çš„æ’ä»¶åˆ—è¡¨ |
| ignore_patterns | list[str] | [] | å¿½ç•¥çš„é”™è¯¯æ¨¡å¼ |

### é…ç½®ç¤ºä¾‹

```python
error_manager_config = {
    # åŸºç¡€é…ç½®
    "error_image_quality": 50,
    "error_image_font": "C:/Windows/Fonts/msyh.ttc",
    
    # é‚®ä»¶é…ç½®
    "enable_email": True,
    "smtp_user": "your_email@qq.com",
    "smtp_password": "your_password",
    "email_to": ["admin@example.com"],
    
    # å®šæ—¶æŠ¥å‘Š
    "enable_scheduled_report": True,
    "report_mode": "time",
    "report_interval": "0 0 * * *",
    
    # é”™è¯¯è¿‡æ»¤
    "ignored_plugins": ["plugin1", "plugin2"],
    "ignore_patterns": ["*timeout*", "*connection refused*"]
}
```

## ğŸ® ä½¿ç”¨æ–¹æ³•

### åŸºç¡€å‘½ä»¤

- `/é”™è¯¯ç®¡ç† æŸ¥çœ‹ [é¡µæ•°]` - åˆ†é¡µæŸ¥çœ‹é”™è¯¯è®°å½•
- `/é”™è¯¯ç®¡ç† è¯¦æƒ… [id]` - æŸ¥çœ‹æŒ‡å®šIDçš„é”™è¯¯è¯¦æƒ…
- `/é”™è¯¯ç®¡ç† åˆ é™¤ [id]` - åˆ é™¤æŒ‡å®šIDçš„é”™è¯¯è®°å½•
- `/é”™è¯¯ç®¡ç† ç»Ÿè®¡` - æŸ¥çœ‹é”™è¯¯ç»Ÿè®¡ä¿¡æ¯

### é«˜çº§æŸ¥è¯¢

- `/é”™è¯¯ç®¡ç† æŸ¥æ‰¾ <å­—æ®µå> <å€¼>` - ç²¾ç¡®æŸ¥æ‰¾é”™è¯¯è®°å½•
- `/é”™è¯¯ç®¡ç† æœç´¢ <å…³é”®è¯>` - æ¨¡ç³Šæœç´¢é”™è¯¯è®°å½•
- `/é”™è¯¯ç®¡ç† æ¸…ç©º <ç±»å‹> <å€¼>` - æ‰¹é‡æ¸…ç†é”™è¯¯è®°å½•
  - ç±»å‹ï¼šall/user/bot/date
  - å€¼ï¼šall/ç”¨æˆ·ID/æœºå™¨äººID/æ—¥æœŸ

### åˆ«åæ”¯æŒ

æ”¯æŒä½¿ç”¨ `é”™è¯¯` æˆ– `err` ä½œä¸ºå‘½ä»¤åˆ«åã€‚

### è‡ªå®šä¹‰å¼•å…¥æ–¹æ³•

```python
from nonebot_plugin_error_manager import error_to_images

try:
  #ä»£ç å†…å®¹
except Exception as e:
  img = error_to_images(e)
  #è¿™é‡Œå¡«ä½ å‘é€å›¾ç‰‡çš„æ–¹æ³•
```

## ğŸ“‘ å¼€å‘è®¡åˆ’

### å·²å®ŒæˆåŠŸèƒ½

- âœ… é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ
  - æ”¯æŒå®šæ—¶å‘é€é”™è¯¯æŠ¥å‘Š
  - æ”¯æŒå®æ—¶é”™è¯¯é€šçŸ¥æ¨é€
- âœ… é”™è¯¯ä¿¡æ¯å¢å¼º
  - ä¼˜åŒ–ä¾èµ–æ³¨å…¥æœºåˆ¶
  - æ‰©å±•é”™è¯¯ä¿¡æ¯é‡‡é›†èŒƒå›´
  - ä¼˜åŒ–å‘é€é”™è¯¯ä¿¡æ¯çš„æ˜¾ç¤º
- âœ… è·¨å¹³å°å…¼å®¹æ€§
  - æ”¯æŒä¸»æµèŠå¤©å¹³å°é”™è¯¯æ¨é€
  - ç»Ÿä¸€é”™è¯¯å¤„ç†æ¥å£
- âœ… æŠ¥é”™å¤„ç†å¢å¼º
  - å¿½ç•¥æŒ‡å®šæ’ä»¶çš„æŠ¥é”™
  - å¿½ç•¥æŒ‡å®šæŠ¥é”™ç±»å‹

### è¿›è¡Œä¸­åŠŸèƒ½

- ğŸš§ æ•°æ®å­˜å‚¨ä¼˜åŒ–
  - ORMæ•°æ®åº“åŠ¨æ€åŠ è½½/å¸è½½
  - JSONæ–‡ä»¶å¯¼å…¥å¯¼å‡ºæ”¯æŒ
  - æ•°æ®è¿ç§»å·¥å…·å¼€å‘

### è®¡åˆ’ä¸­åŠŸèƒ½

- ğŸ“‹ ä»£ç é‡æ„ä¸ä¼˜åŒ–
  - æ€§èƒ½ä¼˜åŒ–
  - ä»£ç ç»“æ„é‡ç»„
  - æµ‹è¯•è¦†ç›–ç‡æå‡
  - é”™è¯¯ä¿¡æ¯æ ¼å¼ä¼˜åŒ–
  - å°è¯•ä½¿ç”¨aiæ¥å¤„ç†é”™è¯¯ä¿¡æ¯
  - å°è¯•è‡ªåŠ¨åŒ–è¿ç»´
- ğŸ“‹ å¹³å°é€‚é…æ‰©å±•
  - æ–°å¢å¹³å°æ”¯æŒ
  - ç»Ÿä¸€é€‚é…å™¨æ¥å£

## ğŸ“¸ æ•ˆæœå±•ç¤º

<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test0.png" alt="ç¤ºä¾‹å›¾ç‰‡-1">
<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test1.jpg" alt="ç¤ºä¾‹å›¾ç‰‡-2">
<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test2.jpg" alt="ç¤ºä¾‹å›¾ç‰‡-3">
<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test3.jpg" alt="ç¤ºä¾‹å›¾ç‰‡-4">
<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test4.jpg" alt="ç¤ºä¾‹å›¾ç‰‡-5">
<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test5.jpg" alt="ç¤ºä¾‹å›¾ç‰‡-6">
<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test6.jpg" alt="ç¤ºä¾‹å›¾ç‰‡-7">
<img src="https://raw.githubusercontent.com/huanxin996/nonebot_plugin_error_report/main/example_image/test7.jpg" alt="ç¤ºä¾‹å›¾ç‰‡-8">

## ğŸ™ é¸£è°¢

- [nonebot-plugin-userinfo](https://github.com/none)
- [nonebot_plugin_alconna](https://github.com/none)
- [NoneBot2](https://github.com/nonebot/nonebot2)

## ğŸ“„ å¼€æºåè®®

MIT License

Copyright (c) 2025 huanxin996

## ğŸ“„ æ›´æ–°æ—¥å¿—

### v0.0.2 (2025-03-27)

#### âœ¨ æ–°ç‰¹æ€§

- æ–°å¢é‚®ä»¶é€šçŸ¥åŠŸèƒ½
  - æ”¯æŒé”™è¯¯æŠ¥å‘Šé‚®ä»¶æ¨é€
  - å¯é…ç½®é‚®ä»¶å‘é€è§¦å‘æ¡ä»¶
  - è‡ªå®šä¹‰é‚®ä»¶æ¨¡æ¿æ”¯æŒ
- æ–°å¢æ›´å¥½çš„é…ç½®é¡¹
  - æŒ‡å®šå¿½ç•¥é”™è¯¯ç±»å‹
  - æŒ‡å®šå¿½ç•¥é”™è¯¯æ’ä»¶

#### ğŸ”§ ä¼˜åŒ–

- æ”¹è¿›é”™è¯¯ä¿¡æ¯æ˜¾ç¤ºæ ¼å¼
  - æ·»åŠ æŠ¥é”™æ’ä»¶åç§°
  - ä¼˜åŒ–å †æ ˆä¿¡æ¯å¯è¯»æ€§
  - å¢åŠ é”™è¯¯ä¸Šä¸‹æ–‡å±•ç¤º
  - æ–°å¢æ›´è¯¦ç»†çš„é”™è¯¯ä¿¡æ¯å­˜å‚¨æ ¼å¼
- å®Œå–„é…ç½®é¡¹è¯´æ˜æ–‡æ¡£

#### ğŸ› ä¿®å¤

- ä¿®å¤å›¾ç‰‡ç”Ÿæˆå¤±è´¥æ—¶çš„å¼‚å¸¸å¤„ç†

### v0.0.1 (2025-03-26)

#### ğŸ‰ åˆå§‹å‘å¸ƒ

- å®ç°åŸºç¡€é”™è¯¯æ•è·åŠŸèƒ½
- æ”¯æŒé”™è¯¯ä¿¡æ¯å›¾ç‰‡åŒ–å±•ç¤º
- æ·»åŠ åŸºæœ¬çš„é”™è¯¯ç®¡ç†å‘½ä»¤
- å®Œæˆæ•°æ®åº“å­˜å‚¨åŠŸèƒ½
