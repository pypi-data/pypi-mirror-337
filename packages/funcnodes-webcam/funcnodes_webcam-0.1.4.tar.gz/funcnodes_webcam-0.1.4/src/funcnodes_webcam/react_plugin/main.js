var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)},t={};e.d(t,{A:()=>o});var n=function(e,t,n,r){return new(n||(n=Promise))((function(o,a){function i(e){try{c(r.next(e))}catch(e){a(e)}}function u(e){try{c(r.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,u)}c((r=r.apply(e,t||[])).next())}))},r=function(e,t){var n,r,o,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},i=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return i.next=u(0),i.throw=u(1),i.return=u(2),"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(u){return function(c){return function(u){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,u[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&u[0]?r.return:u[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,u[1])).done)return o;switch(r=0,o&&(u=[2&u[0],o.value]),u[0]){case 0:case 1:o=u;break;case 4:return a.label++,{value:u[1],done:!1};case 5:a.label++,r=u[1],u=[0];continue;case 7:u=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==u[0]&&2!==u[0])){a=0;continue}if(3===u[0]&&(!o||u[1]>o[0]&&u[1]<o[3])){a.label=u[1];break}if(6===u[0]&&a.label<o[1]){a.label=o[1],o=u;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(u);break}o[2]&&a.ops.pop(),a.trys.pop();continue}u=t.call(e,a)}catch(e){u=[6,e],r=0}finally{n=o=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}};const o={renderpluginfactory:function(e){var t=e.React,o=e.fnrf_zst,a={handle_preview_renderers:{},data_overlay_renderers:{},data_preview_renderers:{},data_view_renderers:{},input_renderers:{},node_context_extenders:{},node_hooks:{"webcam.browserwebcam":[function(e){var a,i,u,c=e.nodecontext,l=t.useState(null),d=l[0],s=l[1],v=((null===(a=c.node_data.io.delay_ms)||void 0===a?void 0:a.valuestore())||{preview:{value:1e3}}).preview,f=((null===(i=c.node_data.io.quality)||void 0===i?void 0:i.valuestore())||{preview:{value:70}}).preview,p=((null===(u=c.node_data.io.src)||void 0===u?void 0:u.valuestore())||{preview:{value:null}}).preview;t.useEffect((function(){return function(){n(this,void 0,void 0,(function(){var e,t,n;return r(this,(function(r){switch(r.label){case 0:if(null==(e=null==p?void 0:p.value)||"null"===e)return s(null),[2];r.label=1;case 1:return r.trys.push([1,3,,4]),t=s,[4,navigator.mediaDevices.getUserMedia({video:{deviceId:{exact:e}}})];case 2:return t.apply(void 0,[r.sent()]),[3,4];case 3:return n=r.sent(),console.error("Error accessing webcam:",n),s(null),[3,4];case 4:return[2]}}))}))}(),function(){d&&d.getTracks().forEach((function(e){return e.stop()}))}}),[p]),t.useEffect((function(){!function(){n(this,void 0,void 0,(function(){var e,t,n,a,i,u;return r(this,(function(r){switch(r.label){case 0:return[4,navigator.mediaDevices.getUserMedia({video:!0})];case 1:return r.sent(),[4,navigator.mediaDevices.enumerateDevices()];case 2:for(e=r.sent(),t=[],n=[],a=0;a<e.length;a++)"videoinput"===(i=e[a]).kind&&(t.push(i.deviceId),n.push(i.label||"camera "+(a+1)));return null===(u=o.worker)||void 0===u||u._send_cmd({cmd:"update_io_value_options",kwargs:{nid:c.node_data.id,ioid:"src",options:{options:{type:"enum",values:t,keys:n,nullable:!0}}}}),[2]}}))}))}()}),[]),t.useEffect((function(){if(d&&void 0!==f&&void 0!==v){var e=document.createElement("video");e.srcObject=d,e.play().catch((function(){}));var t=document.createElement("canvas"),a=setInterval((function(){return n(void 0,void 0,void 0,(function(){var a;return r(this,(function(i){return t.width=e.videoWidth,t.height=e.videoHeight,(a=t.getContext("2d"))?(a.drawImage(e,0,0,t.width,t.height),t.toBlob((function(e){return n(void 0,void 0,void 0,(function(){var n,a,i,u;return r(this,(function(r){switch(r.label){case 0:return e?[4,e.arrayBuffer()]:[2];case 1:return n=r.sent(),a=new Uint8Array(n),i=btoa(a.reduce((function(e,t){return e+String.fromCharCode(t)}),"")),null===(u=o.worker)||void 0===u||u.set_io_value({nid:c.node_data.id,ioid:"imagedata",value:{width:t.width,height:t.height,data:i},set_default:!1}),[2]}}))}))}),"image/jpeg",f.value/100),[2]):[2]}))}))}),v.value);return function(){clearInterval(a),e.pause(),e.srcObject=null}}}),[d,f,v])}]}};return a},v:1};var a=t.A;export{a as default};
