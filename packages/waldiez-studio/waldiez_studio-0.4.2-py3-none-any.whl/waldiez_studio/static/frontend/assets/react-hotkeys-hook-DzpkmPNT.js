import{r as e,j as n}from"./react-2vmRwCGL.js";function t(){return t=Object.assign?Object.assign.bind():function(e){for(var n=1;n<arguments.length;n++){var t=arguments[n];for(var o in t)({}).hasOwnProperty.call(t,o)&&(e[o]=t[o])}return e},t.apply(null,arguments)}var o=["shift","alt","meta","mod","ctrl"],r={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function i(e){return(e&&r[e]||e||"").trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function u(e,n){return void 0===n&&(n=","),e.split(n)}function l(e,n,r){void 0===n&&(n="+");var u=e.toLocaleLowerCase().split(n).map((function(e){return i(e)}));return t({},{alt:u.includes("alt"),ctrl:u.includes("ctrl")||u.includes("control"),shift:u.includes("shift"),meta:u.includes("meta"),mod:u.includes("mod")},{keys:u.filter((function(e){return!o.includes(e)})),description:r,hotkey:e})}"undefined"!=typeof document&&(document.addEventListener("keydown",(function(e){void 0!==e.key&&d([i(e.key),i(e.code)])})),document.addEventListener("keyup",(function(e){void 0!==e.key&&f([i(e.key),i(e.code)])}))),"undefined"!=typeof window&&window.addEventListener("blur",(function(){a.clear()}));var a=new Set;function c(e){return Array.isArray(e)}function d(e){var n=Array.isArray(e)?e:[e];a.has("meta")&&a.forEach((function(e){return!function(e){return o.includes(e)}(e)&&a.delete(e.toLowerCase())})),n.forEach((function(e){return a.add(e.toLowerCase())}))}function f(e){var n=Array.isArray(e)?e:[e];"meta"===e?a.clear():n.forEach((function(e){return a.delete(e.toLowerCase())}))}function s(e,n){void 0===n&&(n=!1);var t,o=e.target,r=e.composed,i=null;return i=(t=o).tagName&&!t.tagName.startsWith("-")&&t.tagName.includes("-")&&r?e.composedPath()[0]&&e.composedPath()[0].tagName:o&&o.tagName,c(n)?Boolean(i&&n&&n.some((function(e){var n;return e.toLowerCase()===(null==(n=i)?void 0:n.toLowerCase())}))):Boolean(i&&n&&n)}var v=function(e,n,t){void 0===t&&(t=!1);var o,r,u=n.alt,l=n.meta,d=n.mod,f=n.shift,s=n.ctrl,v=n.keys,y=e.key,m=e.code,p=e.ctrlKey,h=e.metaKey,k=e.shiftKey,g=e.altKey,b=i(m),w=y.toLowerCase();if(!(null!=v&&v.includes(b)||null!=v&&v.includes(w)||["ctrl","control","unknown","meta","alt","shift","os"].includes(b)))return!1;if(!t){if(u===!g&&"alt"!==w)return!1;if(f===!k&&"shift"!==w)return!1;if(d){if(!h&&!p)return!1}else{if(l===!h&&"meta"!==w&&"os"!==w)return!1;if(s===!p&&"ctrl"!==w&&"control"!==w)return!1}}return!(!v||1!==v.length||!v.includes(w)&&!v.includes(b))||(v?(void 0===r&&(r=","),(c(o=v)?o:o.split(r)).every((function(e){return a.has(e.trim().toLowerCase())}))):!v)},y=e.createContext(void 0);function m(e){var t=e.addHotkey,o=e.removeHotkey,r=e.children;return n.jsx(y.Provider,{value:{addHotkey:t,removeHotkey:o},children:r})}function p(e,n){return e&&n&&"object"==typeof e&&"object"==typeof n?Object.keys(e).length===Object.keys(n).length&&Object.keys(e).reduce((function(t,o){return t&&p(e[o],n[o])}),!0):e===n}var h=e.createContext({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),k=function(t){var o=t.initiallyActiveScopes,r=void 0===o?["*"]:o,i=t.children,u=e.useState((null==r?void 0:r.length)>0?r:["*"]),l=u[0],a=u[1],c=e.useState([]),d=c[0],f=c[1],s=e.useCallback((function(e){a((function(n){return n.includes("*")?[e]:Array.from(new Set([].concat(n,[e])))}))}),[]),v=e.useCallback((function(e){a((function(n){return 0===n.filter((function(n){return n!==e})).length?["*"]:n.filter((function(n){return n!==e}))}))}),[]),y=e.useCallback((function(e){a((function(n){return n.includes(e)?0===n.filter((function(n){return n!==e})).length?["*"]:n.filter((function(n){return n!==e})):n.includes("*")?[e]:Array.from(new Set([].concat(n,[e])))}))}),[]),k=e.useCallback((function(e){f((function(n){return[].concat(n,[e])}))}),[]),g=e.useCallback((function(e){f((function(n){return n.filter((function(n){return!p(n,e)}))}))}),[]);return n.jsx(h.Provider,{value:{enabledScopes:l,hotkeys:d,enableScope:s,disableScope:v,toggleScope:y},children:n.jsx(m,{addHotkey:k,removeHotkey:g,children:i})})};var g=function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation()},b="undefined"!=typeof window?e.useLayoutEffect:e.useEffect;function w(n,t,o,r){var a=e.useState(null),m=a[0],k=a[1],w=e.useRef(!1),C=o instanceof Array?r instanceof Array?void 0:r:o,L=c(n)?n.join(null==C?void 0:C.splitKey):n,E=o instanceof Array?o:r instanceof Array?r:void 0,S=e.useCallback(t,null!=E?E:[]),A=e.useRef(S);A.current=E?S:t;var j=function(n){var t=e.useRef(void 0);return p(t.current,n)||(t.current=n),t.current}(C),K=e.useContext(h).enabledScopes,O=e.useContext(y);return b((function(){if(!1!==(null==j?void 0:j.enabled)&&(e=K,n=null==j?void 0:j.scopes,0===e.length&&n||!n||e.some((function(e){return n.includes(e)}))||e.includes("*"))){var e,n,t=function(e,n){var t;if(void 0===n&&(n=!1),!s(e,["input","textarea","select"])||s(e,null==j?void 0:j.enableOnFormTags)){if(null!==m){var o=m.getRootNode();if((o instanceof Document||o instanceof ShadowRoot)&&o.activeElement!==m&&!m.contains(o.activeElement))return void g(e)}(null==(t=e.target)||!t.isContentEditable||null!=j&&j.enableOnContentEditable)&&u(L,null==j?void 0:j.splitKey).forEach((function(t){var o,r=l(t,null==j?void 0:j.combinationKey);if(v(e,r,null==j?void 0:j.ignoreModifiers)||null!=(o=r.keys)&&o.includes("*")){if(null!=j&&null!=j.ignoreEventWhen&&j.ignoreEventWhen(e))return;if(n&&w.current)return;if(function(e,n,t){("function"==typeof t&&t(e,n)||!0===t)&&e.preventDefault()}(e,r,null==j?void 0:j.preventDefault),!function(e,n,t){return"function"==typeof t?t(e,n):!0===t||void 0===t}(e,r,null==j?void 0:j.enabled))return void g(e);A.current(e,r),n||(w.current=!0)}}))}},o=function(e){void 0!==e.key&&(d(i(e.code)),(void 0===(null==j?void 0:j.keydown)&&!0!==(null==j?void 0:j.keyup)||null!=j&&j.keydown)&&t(e))},r=function(e){void 0!==e.key&&(f(i(e.code)),w.current=!1,null!=j&&j.keyup&&t(e,!0))},a=m||(null==C?void 0:C.document)||document;return a.addEventListener("keyup",r),a.addEventListener("keydown",o),O&&u(L,null==j?void 0:j.splitKey).forEach((function(e){return O.addHotkey(l(e,null==j?void 0:j.combinationKey,null==j?void 0:j.description))})),function(){a.removeEventListener("keyup",r),a.removeEventListener("keydown",o),O&&u(L,null==j?void 0:j.splitKey).forEach((function(e){return O.removeHotkey(l(e,null==j?void 0:j.combinationKey,null==j?void 0:j.description))}))}}}),[m,L,j,K]),k}export{k as H,w as u};
