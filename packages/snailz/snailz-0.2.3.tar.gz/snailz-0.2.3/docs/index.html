
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="assays/">
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.9">
    
    
      
        <title>Snailz Docs</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.4af4bdda.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#snailz" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Snailz Docs" class="md-header__button md-logo" aria-label="Snailz Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Snailz Docs
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Snailz
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Snailz Docs" class="md-nav__button md-logo" aria-label="Snailz Docs" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Snailz Docs
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Snailz
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Snailz
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#for-users" class="md-nav__link">
    <span class="md-ellipsis">
      For Users
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-dictionary" class="md-nav__link">
    <span class="md-ellipsis">
      Data Dictionary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="assays/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Assays
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="clui/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Clui
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="grid/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Grid
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="mangle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mangle
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="people/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    People
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="specimens/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Specimens
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="utils/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Utils
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#for-users" class="md-nav__link">
    <span class="md-ellipsis">
      For Users
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#parameters" class="md-nav__link">
    <span class="md-ellipsis">
      Parameters
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#data-dictionary" class="md-nav__link">
    <span class="md-ellipsis">
      Data Dictionary
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="snailz">Snailz</h1>
<p><img src="https://raw.githubusercontent.com/gvwilson/snailz/main/img/snail-logo.svg" alt="snail logo" width="200px"></p>
<p>These synthetic data generators model genomic analysis of snails in
the Pacific Northwest that are growing to unusual size as a result of
exposure to pollution. At a high level:</p>
<ul>
<li>A <em>grid</em> is created to record the <em>pollution levels</em> at a sampling site.</li>
<li>One or more <em>specimens</em> are collected from the grid.
    Each specimen has a <em>genome</em> and a <em>mass</em>.</li>
<li><em>Laboratory staff</em> design and perform <em>assays</em> of those genomes.</li>
<li>Each assay is represented by a <em>design file</em> and an <em>assay file</em>.</li>
<li>Assay files are mangled to create <em>raw</em> files with formatting glitches.</li>
</ul>
<p>In more detail:</p>
<ul>
<li>
<p><code>snailz</code> uses <a href="https://en.wikipedia.org/wiki/Invasion_percolation">invasion percolation</a>
    to create a square grid of integers
    in which 0 marks sample sites without pollution and positive values show how polluted a site is.
    Invasion percolation guarantees that all of the polluted sites are connected,
    so one exercise is to try to find the origin of the pollution.
    (In the present version it is always the center of the grid,
    but that could easily be modified.)</p>
</li>
<li>
<p>The package also generates a set of snails (referred to as "specimens"),
    each of which has a genome represented as a single string of ACGT bases,
    a body mass,
    and the grid coordinates where it was collected.
    Individual genomes are created by mutating a reference genome at several randomly-selected loci.
    One combination of locus and single-nucleotide polymorphism are considered "significant":
    if a snail has that mutation at that locus <em>and</em> is collected from a polluted sample site,
    its mass is increased by an amount that depends on how polluted the site is.</p>
</li>
<li>
<p><code>snailz</code> uses Python's <a href="https://faker.readthedocs.io/">faker</a> module
    to generate a set of laboratory staff with personal and family names.</p>
</li>
<li>
<p>Every specimen is used in an assay,
    which is performed by a single member of staff on a particular date.
    Each assay is represented by two CSV files:
    a design file which records whether each well in the assay plate contained a control (C) or a specimen sample (S),
    and an assay file which records the response measured in each well.
    If the well contains a control, the assay value is a small (positive) amount of noise.
    If the well contains genetic material from a specimen that <em>doesn't</em> have the significant mutation,
    the assay value is some intermediate value with added noise,
    while the assay value for a specimen with the significant mutation is a larger value (also with noise).</p>
</li>
<li>
<p>Finally, a "raw" assay file is created by taking the clean ones
    and introducing zero or more deliberate formatting errors
    to simulate the kind of data that laboratories commonly produce.</p>
</li>
</ul>
<h2 id="for-users">For Users</h2>
<ol>
<li><code>pip install snailz</code> (or the equivalent command for your Python environment).</li>
<li><code>snailz --help</code> to see available commands.</li>
</ol>
<table>
<thead>
<tr>
<th>Command</th>
<th>Action</th>
</tr>
</thead>
<tbody>
<tr>
<td>assays</td>
<td>Generate assays for specimens within a date range.</td>
</tr>
<tr>
<td>convert</td>
<td>Convert JSON data to CSV format.</td>
</tr>
<tr>
<td>grid</td>
<td>Generate grid.</td>
</tr>
<tr>
<td>init</td>
<td>Initialize parameter files for snailz.</td>
</tr>
<tr>
<td>mangle</td>
<td>Modify assay files by reassigning people.</td>
</tr>
<tr>
<td>people</td>
<td>Generate people.</td>
</tr>
<tr>
<td>specimens</td>
<td>Generate specimens.</td>
</tr>
</tbody>
</table>
<h2 id="parameters">Parameters</h2>
<p><img src="https://raw.githubusercontent.com/gvwilson/snailz/main/img/workflow.png" alt="workflow"></p>
<p><code>./params</code> contains the parameter files used to control generation of the reference dataset.</p>
<ul>
<li><code>grid.json</code><ul>
<li><code>depth</code>: integer range of random values in cells</li>
<li><code>seed</code>: RNG seed</li>
<li><code>size</code>: width and height of (square) grid in cells</li>
</ul>
</li>
<li><code>people.json</code><ul>
<li><code>locale</code>: language and region to use for name generation</li>
<li><code>number</code>: number of staff to create</li>
<li><code>seed</code>: RNG seed</li>
</ul>
</li>
<li><code>specimens.json</code><ul>
<li><code>length</code>: genome length in characters</li>
<li><code>max_mass</code>: maximum specimen mass</li>
<li><code>min_mass</code>: minimum specimen mass</li>
<li><code>mut_scale</code>: scaling factor for mutated specimens</li>
<li><code>mutations</code>: number of mutations to introduce</li>
<li><code>number</code>: number of specimens to create</li>
<li><code>seed</code>: RNG seed</li>
</ul>
</li>
<li><code>assays.json</code><ul>
<li><code>baseline</code>: assay response for unmutated specimens</li>
<li><code>end_date</code>: date of final assay</li>
<li><code>mutant</code>: assay response for mutated specimens</li>
<li><code>noise</code>: noise to add to control cells</li>
<li><code>plate_size</code>: width and height of assay plate</li>
<li><code>seed</code>: RNG seed</li>
<li><code>start_date</code>: date of first assay</li>
</ul>
</li>
</ul>
<p>Note: there are no parameters for assay file mangling.</p>
<h2 id="data-dictionary">Data Dictionary</h2>
<p><code>doit all</code> creates these files in <code>tmp</code> using the sample parameters in <code>params</code>:</p>
<ul>
<li><code>assays/</code><ul>
<li><code>NNNNNN_assay.csv</code>: tidy, consistently-formatted CSV file with assay result.</li>
<li><code>NNNNNN_design.csv</code>: tidy, consistently-formatted CSV file with assay design.</li>
<li><code>NNNNNN_raw.csv</code>: CSV file derived from <code>NNNNNN_assay.csv</code> with randomly-introduced formatting errors.</li>
</ul>
</li>
<li><code>assays.csv</code>: CSV file containing summary of assay metadata with columns.<ul>
<li><code>ident</code>: assay identifier (integer).</li>
<li><code>specimen_id</code>: specimen identifier (text).</li>
<li><code>performed</code>: assay date (date).</li>
<li><code>performed_by</code>: person identifier (text).</li>
</ul>
</li>
<li><code>assays.json</code>: all assay data in JSON format.</li>
<li><code>grid.csv</code>: CSV file containing pollution grid values.<ul>
<li>This file is a matrix of values with no column IDs or row IDs.</li>
</ul>
</li>
<li><code>grid.json</code>: grid data as JSON.</li>
<li><code>people.csv</code>: CSV file describing experimental staff members.<ul>
<li><code>ident</code>: person identifier (text)</li>
<li><code>personal</code>: personal name (text)</li>
<li><code>family</code>: family name (text)</li>
</ul>
</li>
<li><code>people.json</code>: staff member data in JSON format.</li>
<li><code>specimens.csv</code>: CSV file containing details of snail specimens.<ul>
<li><code>ident</code>: specimen identifier (text)</li>
<li><code>x</code>: X coordinate of collection cell (integer)</li>
<li><code>y</code>: Y coordinate of collection cell (integer)</li>
<li><code>genome</code>: base sequence (text)</li>
<li><code>mass</code>: snail mass (real)</li>
</ul>
</li>
<li><code>specimens.json</code>: specimen data in JSON format.</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": ".", "features": [], "search": "assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="assets/javascripts/bundle.c8b220af.min.js"></script>
      
    
  </body>
</html>