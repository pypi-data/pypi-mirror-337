component:
  flow_name: transform
  metadata:
    source:
      path: flows/transform/components/metabook.sql.jinja
  name: metabook
  transform:
    inputs:
    - flow: extract-load
      name: read_metabook
    lookback: 1
    microbatch: false
    sql: |-
      WITH metabook AS (
          SELECT
              *
          FROM
              {{ ref("read_metabook", flow="extract-load") }}
      )
      SELECT
          *
      FROM
          metabook
      ORDER BY
          timestamp DESC
    strategy: table