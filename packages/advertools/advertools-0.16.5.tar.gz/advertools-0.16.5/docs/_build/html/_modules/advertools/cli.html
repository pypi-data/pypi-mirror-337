<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>advertools.cli &mdash;  Python</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../../_static/jquery.js?v=5d32c60e"></script>
        <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../../_static/documentation_options.js?v=81998473"></script>
        <script src="../../_static/doctools.js?v=9bcbadda"></script>
        <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
        <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
        <script async="async" src="https://unpkg.com/thebe@0.8.2/lib/index.js"></script>
        <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            advertools
          </a>
              <div class="version">
                0.16.4
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../../readme.html">About advertools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.survey.html">Survey - your feedback</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.cli.cli.html">Command Line Interface</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SEM</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.kw_generate.html">Generate SEM Keywords</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.ad_create.html">Create Text Ads on a Large Scale</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.ad_from_string.html">Create Text Ads From Description Text</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">SEO</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.robotstxt.html">robots.txt</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.sitemaps.html">XML Sitemaps</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.spider.html">SEO Spider / Crawler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.code_recipes.spider_strategies.html">Crawl Strategies</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.crawlytics.html">Crawl Analytics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.header_spider.html">Crawl headers (HEAD method only)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.image_spider.html">Crawl images</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.logs.html">Python Log File Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.logs.html#parse-and-analyze-crawl-logs-in-a-dataframe">Parse and Analyze Crawl Logs in a Dataframe</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.reverse_dns_lookup.html">Reverse DNS Lookup</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.serp.html">Analyze Search Engine Results (SERPs)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.knowledge_graph.html">Google's Knowledge Graph</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Text &amp; Content Analysis</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.urlytics.html">URL Structure Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.emoji.html">Emoji Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.extract.html">Extract Structured Entities from Text</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.stopwords.html">Stop Words</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.word_frequency.html">Text Analysis (absolute &amp; weighted word frequency)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.word_tokenize.html">Word Tokenization (N-grams)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Social Media</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.twitter.html">Twitter Data API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advertools.youtube.html">YouTube Data API</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Index &amp; Change Log</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../include_changelog.html">Index &amp; Change Log</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">advertools</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">advertools.cli</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for advertools.cli</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">platform</span>
<span class="kn">import</span> <span class="nn">socket</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">concurrent</span> <span class="kn">import</span> <span class="n">futures</span>
<span class="kn">from</span> <span class="nn">textwrap</span> <span class="kn">import</span> <span class="n">dedent</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="kn">import</span> <span class="nn">advertools</span> <span class="k">as</span> <span class="nn">adv</span>
<span class="kn">from</span> <span class="nn">advertools</span> <span class="kn">import</span> <span class="n">__version__</span>

<span class="n">system</span> <span class="o">=</span> <span class="n">platform</span><span class="o">.</span><span class="n">system</span><span class="p">()</span>

<span class="n">_max_workers</span> <span class="o">=</span> <span class="mi">60</span> <span class="k">if</span> <span class="n">system</span> <span class="o">==</span> <span class="s2">&quot;Darwin&quot;</span> <span class="k">else</span> <span class="mi">600</span>

<span class="n">_entity_dict</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;emoji&quot;</span><span class="p">:</span> <span class="n">adv</span><span class="o">.</span><span class="n">emoji</span><span class="o">.</span><span class="n">EMOJI</span><span class="p">,</span>
    <span class="s2">&quot;hashtags&quot;</span><span class="p">:</span> <span class="n">adv</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">HASHTAG</span><span class="p">,</span>
    <span class="s2">&quot;mentions&quot;</span><span class="p">:</span> <span class="n">adv</span><span class="o">.</span><span class="n">regex</span><span class="o">.</span><span class="n">MENTION</span><span class="p">,</span>
<span class="p">}</span>


<span class="k">def</span> <span class="nf">_make_headline</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">len_</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
    <span class="n">top</span> <span class="o">=</span> <span class="s2">&quot;═&quot;</span> <span class="o">*</span> <span class="n">len_</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="s2">&quot;═&quot;</span> <span class="o">*</span> <span class="n">len_</span>
    <span class="k">return</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span>
        <span class="p">[(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span><span class="p">)</span> <span class="o">+</span> <span class="n">top</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span><span class="p">)</span> <span class="o">+</span> <span class="n">text</span><span class="p">,</span> <span class="p">(</span><span class="s2">&quot; &quot;</span> <span class="o">*</span> <span class="n">indent</span><span class="p">)</span> <span class="o">+</span> <span class="n">bottom</span><span class="p">]</span>
    <span class="p">)</span>


<span class="n">epilog</span> <span class="o">=</span> <span class="n">_make_headline</span><span class="p">(</span><span class="s2">&quot;full documentation at https://bit.ly/adv_docs&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_split_options</span><span class="p">(</span><span class="n">options</span><span class="p">):</span>
    <span class="n">opsplit</span> <span class="o">=</span> <span class="p">[</span><span class="n">op</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;=&quot;</span><span class="p">,</span> <span class="n">maxsplit</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">op</span> <span class="ow">in</span> <span class="n">options</span><span class="p">]</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">opsplit</span><span class="p">}</span>
    <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">d</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;True&quot;</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">v</span> <span class="o">==</span> <span class="s2">&quot;False&quot;</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">d</span>


<span class="k">def</span> <span class="nf">_format_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">head</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">precision</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">df</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">int</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="s2">&quot;,&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">dtype</span> <span class="o">==</span> <span class="nb">float</span><span class="p">:</span>
            <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="nb">format</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;,.</span><span class="si">{</span><span class="n">precision</span><span class="si">}</span><span class="s2">f&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="n">head</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">_single_request</span><span class="p">(</span><span class="n">ip</span><span class="p">):</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">hostname</span><span class="p">,</span> <span class="n">aliaslist</span><span class="p">,</span> <span class="n">ipaddrlist</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">gethostbyaddr</span><span class="p">(</span><span class="n">ip</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ip</span><span class="p">,</span> <span class="n">hostname</span><span class="p">,</span> <span class="s2">&quot;@@&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">aliaslist</span><span class="p">),</span> <span class="s2">&quot;@@&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ipaddrlist</span><span class="p">)]</span>
    <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">[</span><span class="n">ip</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)]</span>


<span class="k">def</span> <span class="nf">_cli_reverse_dns_lookup</span><span class="p">(</span><span class="n">ip_list</span><span class="p">,</span> <span class="n">max_workers</span><span class="o">=</span><span class="mi">600</span><span class="p">):</span>
    <span class="n">socket</span><span class="o">.</span><span class="n">setdefaulttimeout</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
    <span class="n">count_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">ip_list</span><span class="p">)</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()</span>
    <span class="n">count_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">]</span>
    <span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;cum_count&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>
    <span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;perc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">div</span><span class="p">(</span><span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;count&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    <span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;cum_perc&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;perc&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">cumsum</span><span class="p">()</span>

    <span class="n">hosts</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">with</span> <span class="n">futures</span><span class="o">.</span><span class="n">ThreadPoolExecutor</span><span class="p">(</span><span class="n">max_workers</span><span class="o">=</span><span class="n">max_workers</span><span class="p">)</span> <span class="k">as</span> <span class="n">executor</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">host</span> <span class="ow">in</span> <span class="n">executor</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">_single_request</span><span class="p">,</span> <span class="n">count_df</span><span class="p">[</span><span class="s2">&quot;ip_address&quot;</span><span class="p">]):</span>
            <span class="n">hosts</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">host</span><span class="p">)</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">hosts</span><span class="p">)</span>
    <span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="s2">&quot;hostname&quot;</span><span class="p">,</span> <span class="s2">&quot;aliaslist&quot;</span><span class="p">,</span> <span class="s2">&quot;ipaddrlist&quot;</span><span class="p">,</span> <span class="s2">&quot;errors&quot;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">df</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">4</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>

    <span class="n">final_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">merge</span><span class="p">(</span>
        <span class="n">count_df</span><span class="p">,</span> <span class="n">df</span><span class="p">,</span> <span class="n">left_on</span><span class="o">=</span><span class="s2">&quot;ip_address&quot;</span><span class="p">,</span> <span class="n">right_on</span><span class="o">=</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s2">&quot;left&quot;</span>
    <span class="p">)</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="s2">&quot;ip&quot;</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">final_df</span>


<div class="viewcode-block" id="RawTextDefArgFormatter">
<a class="viewcode-back" href="../../advertools.cli.html#advertools.cli.RawTextDefArgFormatter">[docs]</a>
<span class="k">class</span> <span class="nc">RawTextDefArgFormatter</span><span class="p">(</span>
    <span class="n">argparse</span><span class="o">.</span><span class="n">RawTextHelpFormatter</span><span class="p">,</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentDefaultsHelpFormatter</span>
<span class="p">):</span>
    <span class="k">pass</span></div>



<div class="viewcode-block" id="main">
<a class="viewcode-back" href="../../advertools.cli.html#advertools.cli.main">[docs]</a>
<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span>
        <span class="n">prog</span><span class="o">=</span><span class="s2">&quot;advertools&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;Productivity and analysis tools for SEO, SEM, &amp; digital marketing&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-v&quot;</span><span class="p">,</span> <span class="s2">&quot;--version&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;version&quot;</span><span class="p">,</span> <span class="n">version</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;advertools </span><span class="si">{</span><span class="n">__version__</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="p">)</span>

    <span class="n">subparsers</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">add_subparsers</span><span class="p">(</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;for help select a command and run: `advertools &lt;command&gt; --help`&quot;</span>
    <span class="p">)</span>

    <span class="c1"># robots --------------------------</span>

    <span class="k">def</span> <span class="nf">robots</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">url</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">url</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">output_file</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;output_file:&quot;</span><span class="p">,</span> <span class="n">output_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url</span> <span class="o">=</span> <span class="p">[</span><span class="n">u</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: please provide a value for url&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">adv</span><span class="o">.</span><span class="n">robotstxt_to_df</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">adv</span><span class="o">.</span><span class="n">robotstxt_to_df</span><span class="p">(</span><span class="n">url</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">robots_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;robots&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;convert a robots.txt file (or list of file URLs) to a table in a CSV format</span>

<span class="s2">you can provide a web URL, or a local file URL on your local machine</span>
<span class="s2">e.g. file:///Users/path/to/robots.txt</span>

<span class="s2">examples:</span>
<span class="s2">---------</span>

<span class="s2">advertools robots https://www.google.com/robots.txt</span>

<span class="s2">multiple robots files:</span>

<span class="s2">advertools robots https://www.google.com/robots.txt https://www.google.jo/robots.txt  https://www.google.es/robots.txt</span>

<span class="s2">use output redirection &quot;&gt;&quot; to save to a CSV file:</span>

<span class="s2">advertools robots https://www.google.com/robots.txt &gt; google_robots.csv</span>

<span class="s2">run the function for a long list of robots files saved in a text file (robotslist.txt):</span>

<span class="s2">advertools robots &lt; robotslist.txt &gt; multi_robots.csv</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">robots_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;url&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a robots.txt URL (or a list of URLs)&quot;</span>
    <span class="p">)</span>
    <span class="n">robots_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-o&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--output-file&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;Path to an output file if you want to save it (has to end with .jl)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">robots_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">robots</span><span class="p">)</span>

    <span class="c1"># sitemaps --------------------------</span>

    <span class="k">def</span> <span class="nf">sitemaps</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">sitemap_url</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">sitemap_url</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">sitemap_url</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">sitemap_url</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: please provide a value for sitemap_url&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sitemap_df</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">sitemap_to_df</span><span class="p">(</span><span class="n">sitemap_url</span><span class="p">,</span> <span class="n">recursive</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">recursive</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">sitemap_df</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">col</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;news&quot;</span><span class="p">,</span> <span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="s2">&quot;news_publication&quot;</span><span class="p">]:</span>
                <span class="k">del</span> <span class="n">sitemap_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">sitemap_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">sep</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">separator</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">sitemaps_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;sitemaps&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;download, parse, and save an XML sitemap to a table in a CSV file&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sitemaps_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;sitemap_url&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;?&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;the URL of the XML sitemap (regular or sitemap index)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sitemaps_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-r&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--recursive&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;whether or not to fetch sub-sitemaps if it is a sitemap index file&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">sitemaps_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--separator&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;the separator with which to separate columns of the output&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">sitemaps_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">sitemaps</span><span class="p">)</span>

    <span class="c1"># urls --------------------------</span>

    <span class="k">def</span> <span class="nf">urls</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">url_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: please provide a value for url_list&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">adv</span><span class="o">.</span><span class="n">url_to_df</span><span class="p">(</span><span class="n">url_list</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">urls_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;urls&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;split a list of URLs into their components: scheme, netloc, path, query, etc.&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">urls_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;url_list&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a list of URLs to parse&quot;</span><span class="p">)</span>
    <span class="n">urls_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">urls</span><span class="p">)</span>

    <span class="c1"># headers --------------------------</span>

    <span class="k">def</span> <span class="nf">headers</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">url_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: please provide a value for url_list&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span> <span class="o">=</span> <span class="n">_split_options</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span><span class="p">)</span>
        <span class="n">adv</span><span class="o">.</span><span class="n">crawl_headers</span><span class="p">(</span>
            <span class="n">url_list</span><span class="o">=</span><span class="n">url_list</span><span class="p">,</span>
            <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
            <span class="n">custom_settings</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">headers_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;headers&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;crawl a list of known URLs using the HEAD method</span>
<span class="s2">return status codes and all available response headers&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">headers_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;url_list&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a list of URLs&quot;</span><span class="p">)</span>
    <span class="n">headers_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;output_file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - where to save the output (.jl)&quot;</span>
    <span class="p">)</span>
    <span class="n">headers_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--custom-settings&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;settings that modify the behavior of the crawler</span>
<span class="s2">settings should be separated by spaces, and each setting name and value should</span>
<span class="s2">be separated by an equal sign &#39;=&#39; without spaces between them</span>

<span class="s2">example:</span>

<span class="s2">advertools headers https://example.com example.jl --custom-settings LOG_FILE=logs.log CLOSESPIDER_TIMEOUT=20</span>
<span class="s2">&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">headers_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">headers</span><span class="p">)</span>

    <span class="c1"># logs --------------------------</span>

    <span class="k">def</span> <span class="nf">logs</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="n">adv</span><span class="o">.</span><span class="n">logs_to_df</span><span class="p">(</span>
            <span class="n">log_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">log_file</span><span class="p">,</span>
            <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
            <span class="n">errors_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">errors_file</span><span class="p">,</span>
            <span class="n">log_format</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">log_format</span><span class="p">,</span>
            <span class="n">fields</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">fields</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;saved to </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">logs_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;logs&quot;</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;parse, compress and convert a log file to a DataFrame in the .parquet format&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logs_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;log_file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - the log file&quot;</span><span class="p">)</span>
    <span class="n">logs_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;output_file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - where to save the output (.parquet)&quot;</span>
    <span class="p">)</span>
    <span class="n">logs_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;errors_file&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - where to save the error lines (.txt)&quot;</span>
    <span class="p">)</span>
    <span class="n">logs_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;log_format&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;common&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;the format of the logs, available defaults are:</span>
<span class="s2">    common, combined, common_with_vhost, nginx_error, apache_error</span>
<span class="s2">    supply a special regex instead if you have a different format&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logs_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-f&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--fields&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;in case you have a special log format, provide a list of the fields names</span>
<span class="s2">which will become column names in the parsed compressed file&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">logs_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">logs</span><span class="p">)</span>

    <span class="c1"># dns --------------------------</span>

    <span class="k">def</span> <span class="nf">dns</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">ip_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">ip_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ip_list</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">ip_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;please provide a value for ip_list&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">host_df</span> <span class="o">=</span> <span class="n">_cli_reverse_dns_lookup</span><span class="p">(</span><span class="n">ip_list</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">host_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">dns_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;dns&quot;</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;perform a reverse DNS lookup on a list of IP addresses&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">dns_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;ip_list&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a list of IP addresses&quot;</span><span class="p">)</span>
    <span class="n">dns_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">dns</span><span class="p">)</span>

    <span class="c1"># keywords --------------------------</span>

    <span class="k">def</span> <span class="nf">semkw</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="n">prod_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">products</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
        <span class="n">word_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">line</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">args</span><span class="o">.</span><span class="n">words</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
        <span class="n">kw_df</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">kw_generate</span><span class="p">(</span>
            <span class="n">prod_list</span><span class="p">,</span>
            <span class="n">word_list</span><span class="p">,</span>
            <span class="n">max_len</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">max_len</span><span class="p">,</span>
            <span class="n">match_types</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">match_types</span><span class="p">,</span>
            <span class="n">capitalize_adgroups</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">capitalize_adgroups</span><span class="p">),</span>
            <span class="n">order_matters</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">order_matters</span><span class="p">),</span>
            <span class="n">campaign_name</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">campaign_name</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">kw_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">kwds_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;semkw&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;generate a table of SEM keywords by supplying a list of products and a list of intent words&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;products&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">open</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a file containing the products that you sell, one per line&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;words&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">open</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a file containing the intent words/phrases that you want to combine with products, one per line&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-t&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--match-types&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="s2">&quot;phrase&quot;</span><span class="p">],</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;exact&quot;</span><span class="p">,</span> <span class="s2">&quot;phrase&quot;</span><span class="p">,</span> <span class="s2">&quot;modified&quot;</span><span class="p">,</span> <span class="s2">&quot;broad&quot;</span><span class="p">],</span>
    <span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--max-len&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;the number of words that should be combined with products&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-c&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--capitalize-adgroups&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;whether or not to capitalize ad group names in the output file&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-m&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--order-matters&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">choices</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">do you want combinations and permutations, or just combinations?</span>
<span class="s2">&quot;buy product&quot; and &quot;product buy&quot; or just &quot;buy product&quot;?&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;-n&quot;</span><span class="p">,</span> <span class="s2">&quot;--campaign-name&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;SEM_campaign&quot;</span><span class="p">)</span>
    <span class="n">kwds_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">semkw</span><span class="p">)</span>

    <span class="c1"># stopwords --------------------------</span>

    <span class="k">def</span> <span class="nf">stopwords</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="nb">sorted</span><span class="p">(</span><span class="n">adv</span><span class="o">.</span><span class="n">stopwords</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">language</span><span class="p">]),</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">stopwords_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;stopwords&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;get stopwords of the selected language&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">stopwords_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;language&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">adv</span><span class="o">.</span><span class="n">stopwords</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="n">stopwords_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">stopwords</span><span class="p">)</span>

    <span class="c1"># word_freq --------------------------</span>

    <span class="k">def</span> <span class="nf">word_freq</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">text_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">text_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;please provide a value for text_list&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="c1"># text_list = pd.read_csv(args.text_list, header=None)[0]</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">number_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">num_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">number_list</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">num_list</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">text_list</span><span class="p">))]</span>
        <span class="n">wordfreq_df</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">word_frequency</span><span class="p">(</span>
            <span class="n">text_list</span><span class="o">=</span><span class="n">text_list</span><span class="p">,</span>
            <span class="n">num_list</span><span class="o">=</span><span class="n">num_list</span><span class="p">,</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">regex</span><span class="p">,</span>
            <span class="n">phrase_len</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">phrase_len</span><span class="p">,</span>
            <span class="n">rm_words</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">stopwords</span> <span class="ow">or</span> <span class="n">adv</span><span class="o">.</span><span class="n">stopwords</span><span class="p">[</span><span class="s2">&quot;english&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">wordfreq_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">wordfreq_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;wordfreq&quot;</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;get word counts of a text list optionally weighted by a number list</span>

<span class="s2">words (tokens) can be tokenized using any pattern with the --regex option</span>
<span class="s2">word/phrase lengths can also be modified using the --phrase-len option&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">wordfreq_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;text_list&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a text list, one document (sentence, tweet, etc.) per line&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">wordfreq_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-n&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--number-list&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - a file containing the number list, one number per line&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">wordfreq_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-r&quot;</span><span class="p">,</span> <span class="s2">&quot;--regex&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;a regex to tokenize words&quot;</span>
    <span class="p">)</span>
    <span class="n">wordfreq_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--phrase-len&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;the phrase (token) length to split words (the `n` in n-grams)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">wordfreq_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--stopwords&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">required</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="n">dedent</span><span class="p">(</span><span class="s2">&quot;&quot;&quot;</span><span class="se">\</span>
<span class="s2">    a list of stopwords to exclude when counting, defaults to English stopwords</span>
<span class="s2">    run `advertools stopwords english` to get the stopwords</span>
<span class="s2">    change the language to get other stopwords&quot;&quot;&quot;</span><span class="p">),</span>
    <span class="p">)</span>
    <span class="n">wordfreq_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">word_freq</span><span class="p">)</span>

    <span class="c1"># emoji --------------------------</span>

    <span class="k">def</span> <span class="nf">emoji</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="n">emoji_df</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">emoji_search</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">regex</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">emoji_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">emoji_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;emoji&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;search for emoji using a regex&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">emoji_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;regex&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;pattern to search for emoji&quot;</span><span class="p">)</span>
    <span class="n">emoji_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">emoji</span><span class="p">)</span>

    <span class="c1"># extract --------------------------</span>

    <span class="k">def</span> <span class="nf">extract</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="n">text_list</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">text_list</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">None</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">extracted</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span>
            <span class="n">text_list</span><span class="o">=</span><span class="n">text_list</span><span class="p">,</span>
            <span class="n">key_name</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">entity</span><span class="o">.</span><span class="n">rstrip</span><span class="p">(</span><span class="s2">&quot;s&quot;</span><span class="p">),</span>
            <span class="n">regex</span><span class="o">=</span><span class="n">_entity_dict</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">entity</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">extracted_subset</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">key</span><span class="p">:</span> <span class="n">val</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">extracted</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">text_list</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">extracted_subset</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">val</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
                <span class="n">extracted_subset</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">val</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">extracted</span><span class="p">[</span><span class="s2">&quot;overview&quot;</span><span class="p">],</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;&gt;&quot;</span><span class="p">]),</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;top 15 </span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">entity</span><span class="si">}</span><span class="s2">:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="n">top_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">extracted</span><span class="p">[[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">extracted</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;top_&quot;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]],</span>
            <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">top_df</span><span class="p">[:</span><span class="mi">15</span><span class="p">],</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="n">freq_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span>
            <span class="n">extracted</span><span class="p">[[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">extracted</span> <span class="k">if</span> <span class="n">k</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="s2">&quot;_freq&quot;</span><span class="p">)][</span><span class="mi">0</span><span class="p">]]</span>
        <span class="p">)</span>
        <span class="n">freq_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;number of &quot;</span> <span class="o">+</span> <span class="n">args</span><span class="o">.</span><span class="n">entity</span><span class="p">,</span> <span class="s2">&quot;count&quot;</span><span class="p">]</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="si">{</span><span class="n">args</span><span class="o">.</span><span class="n">entity</span><span class="si">}</span><span class="s2"> frequency:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">freq_df</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">extracted_subset</span><span class="p">)</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>

    <span class="n">extract_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;extract&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;extract structured entities from a text list; </span><span class="si">{</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">_entity_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">extract_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;entity&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;which entity you want to extract&quot;</span><span class="p">,</span> <span class="n">choices</span><span class="o">=</span><span class="n">_entity_dict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
    <span class="p">)</span>
    <span class="n">extract_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;text_list&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - a file containing the text list, one phrase per line&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">extract_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">extract</span><span class="p">)</span>

    <span class="c1"># tokenize --------------------------</span>

    <span class="k">def</span> <span class="nf">tokenize</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">text_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">text_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">text</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">text</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">readlines</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">text_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: please provide a value for text_list&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">tokenized</span> <span class="o">=</span> <span class="n">adv</span><span class="o">.</span><span class="n">word_tokenize</span><span class="p">(</span><span class="n">text_list</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="o">*</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">separator</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tokenized</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="n">token_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;tokenize&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;tokenize documents (phrases, keywords, tweets, etc) into token of the desired length&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">token_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;text_list&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - a file containing the text list, one document (sentence, tweet, etc.) per line&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">token_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--length&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;the length of tokens (the n in n-grams)&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">token_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-s&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--separator&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;the character with which to separate the tokens&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">token_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">tokenize</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">crawl</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">isatty</span><span class="p">():</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">url_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">url_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">url</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span> <span class="k">for</span> <span class="n">url</span> <span class="ow">in</span> <span class="n">sys</span><span class="o">.</span><span class="n">stdin</span><span class="o">.</span><span class="n">read</span><span class="p">()</span><span class="o">.</span><span class="n">split</span><span class="p">()]</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">url_list</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;error: please provide a value for url_list&quot;</span><span class="p">,</span> <span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">exclude_url_params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">exclude_url_params</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;True&quot;</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span><span class="p">,</span> <span class="s2">&quot;true&quot;</span><span class="p">]:</span>
                <span class="n">exclude_url_params</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">exclude_url_params</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">exclude_url_params</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">exclude_url_params</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">xpath_selectors</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">xpath_selectors</span> <span class="o">=</span> <span class="n">_split_options</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">xpath_selectors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">css_selectors</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">css_selectors</span> <span class="o">=</span> <span class="n">_split_options</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">css_selectors</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span><span class="p">:</span>
            <span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span> <span class="o">=</span> <span class="n">_split_options</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span><span class="p">)</span>
        <span class="n">adv</span><span class="o">.</span><span class="n">crawl</span><span class="p">(</span>
            <span class="n">url_list</span><span class="o">=</span><span class="n">url_list</span><span class="p">,</span>
            <span class="n">output_file</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">output_file</span><span class="p">,</span>
            <span class="n">allowed_domains</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">allowed_domains</span><span class="p">,</span>
            <span class="n">css_selectors</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">css_selectors</span><span class="p">,</span>
            <span class="n">xpath_selectors</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">xpath_selectors</span><span class="p">,</span>
            <span class="n">follow_links</span><span class="o">=</span><span class="nb">bool</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">follow_links</span><span class="p">)),</span>
            <span class="n">custom_settings</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">custom_settings</span><span class="p">,</span>
            <span class="n">exclude_url_params</span><span class="o">=</span><span class="n">exclude_url_params</span><span class="p">,</span>
            <span class="n">include_url_params</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">include_url_params</span><span class="p">,</span>
            <span class="n">exclude_url_regex</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">exclude_url_regex</span><span class="p">,</span>
            <span class="n">include_url_regex</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">include_url_regex</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">crawl_parser</span> <span class="o">=</span> <span class="n">subparsers</span><span class="o">.</span><span class="n">add_parser</span><span class="p">(</span>
        <span class="s2">&quot;crawl&quot;</span><span class="p">,</span>
        <span class="n">formatter_class</span><span class="o">=</span><span class="n">RawTextDefArgFormatter</span><span class="p">,</span>
        <span class="n">epilog</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">Examples:</span>
<span class="s2">---------</span>

<span class="s2">crawl a website starting from its home page:</span>

<span class="s2">advertools crawl https://examle.com example_output.jl --follow-links 1</span>

<span class="s2">crawl a list of pages (list mode):</span>

<span class="s2">advertools crawl url_1 url_2 url_3 example_output.jl</span>

<span class="s2">OR if you have a long list in a file (url_list.txt):</span>

<span class="s2">advertools crawl &lt; url_list.txt example_output.jl</span>

<span class="s2">stop crawling after having processed 1,000 pages:</span>

<span class="s2">advertools crawl https://examle.com example_output.jl --follow-links 1 --custom-settings CLOSESPIDER_PAGECOUNT=1000</span>
<span class="s2">&quot;&quot;&quot;</span>
        <span class="o">+</span> <span class="n">epilog</span><span class="p">,</span>
        <span class="n">description</span><span class="o">=</span><span class="s2">&quot;SEO crawler&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;url_list&quot;</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;one or more URLs to crawl&quot;</span><span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;output_file&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;filepath - where to save the output (.jl)&quot;</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-l&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--follow-links&quot;</span><span class="p">,</span>
        <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;whether or not to follow links encountered on crawled pages&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;-d&quot;</span><span class="p">,</span>
        <span class="s2">&quot;--allowed-domains&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;while following links, only links on these domains will be followed&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--exclude-url-params&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;a list of URL parameters to exclude while following links</span>
<span class="s2">if a link contains any of those parameters, don&#39;t follow it</span>
<span class="s2">setting it to True will exclude links containing any parameter&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--include-url-params&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;a list of URL parameters to include while following links</span>
<span class="s2">if a link contains any of those parameters, follow it</span>
<span class="s2">having the same parmeters to include and exclude raises an error&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--exclude-url-regex&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;a regular expression of a URL pattern to exclude while following links</span>
<span class="s2">if a link matches the regex don&#39;t follow it&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--include-url-regex&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;a regular expression of a URL pattern to include while following links</span>
<span class="s2">if a link matches the regex follow it&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--css-selectors&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;a dictionary mapping names to CSS selectors</span>
<span class="s2">the names will become column headers, and the selectors will be used to extract the required data/content&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--xpath-selectors&quot;</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;a dictionary mapping names to XPath selectors.</span>
<span class="s2">the names will become column headers, and the selectors will be used to extract the required data/content&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
        <span class="s2">&quot;--custom-settings&quot;</span><span class="p">,</span>
        <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span>
        <span class="n">nargs</span><span class="o">=</span><span class="s2">&quot;*&quot;</span><span class="p">,</span>
        <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;a dictionary of optional custom settings that you might want to</span>
<span class="s2">add to the spider&#39;s functionality.</span>
<span class="s2">there are over 170 settings for all kinds of options</span>
<span class="s2">for details please refer to the spider settings:</span>
<span class="s2">https://docs.scrapy.org/en/latest/topics/settings.html&quot;&quot;&quot;</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="n">crawl_parser</span><span class="o">.</span><span class="n">set_defaults</span><span class="p">(</span><span class="n">func</span><span class="o">=</span><span class="n">crawl</span><span class="p">)</span>
    <span class="n">args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
    <span class="n">args</span><span class="o">.</span><span class="n">func</span><span class="p">(</span><span class="n">args</span><span class="p">)</span></div>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="n">main</span><span class="p">())</span>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Elias Dabbas.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>