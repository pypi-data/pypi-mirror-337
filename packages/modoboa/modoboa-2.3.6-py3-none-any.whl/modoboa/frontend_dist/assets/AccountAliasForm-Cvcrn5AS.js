import{C as L}from"./ChoiceField-2xK3jpng.js";import{u as E,b as S,G as b,i as v,o as A,c as F,w as _,a as m,f as s,e as w,t as h,_ as O,a4 as N,k as B,U as M,R as j,J as Q,V as G,S as I,ab as T}from"./index-Bbkf9DIc.js";import{a as H,V as D}from"./VRow-DnWvWxV-.js";import{V as z}from"./VAlert-Da5j80B0.js";import{h as J}from"./index-CDn75bM3.js";import{V as $,r as U}from"./VForm-BCtIZQOE.js";import{_ as K}from"./AccountPasswordSubForm-Deeun_9B.js";import{E as q}from"./EmailField-Dmv0bzOI.js";import{V as R}from"./VTextField-Djz_9Wz9.js";import{V as k}from"./VSwitch-MOiUeFZQ.js";import{V as P}from"./VChip-DoOT6ijG.js";const W={class:"headline"},X={class:"mt-4"},ve={__name:"AccountRoleForm",props:{modelValue:{type:Object,default:null}},setup(V,{expose:y}){const d=E(),{$gettext:a}=S(),c=V,n=b(),l=v(()=>c.modelValue),p=v(()=>d.authUser),e=v(()=>{const i=x.value.find(g=>g.value===l.value.role);return i!==void 0?i.label:""}),f=v(()=>{const i=x.value.find(g=>g.value===l.value.role);return i!==void 0?i.help:""}),x=v(()=>p.value.role==="SuperAdmins"?[...o,...t,...r,...u]:p.value.role==="DomainAdmins"?[...r]:p.value.role==="Resellers"?[...o,...r]:[]),r=[{label:a("Simple user"),value:"SimpleUsers",help:a("A user with no privileges but with a mailbox. He will be allowed to use all end-user features: webmail, calendar, contacts, filters.")}],o=[{label:a("Domain administrator"),value:"DomainAdmins",help:a("A user with privileges on one or more domain. He will be allowed to administer mailboxes and he can also have a mailbox.")}],t=[{label:a("Reseller"),value:"Resellers",help:a("help")}],u=[{label:a("Super administrator"),value:"SuperAdmins",help:a("A user with all privileges, can do anything. By default, such a user does not have a mailbox so he can't access end-user features.")}];return y({vFormRef:n,roleLabel:e}),(i,g)=>(A(),F($,{ref_key:"vFormRef",ref:n},{default:_(()=>[m(H,null,{default:_(()=>[m(D,{cols:"7"},{default:_(()=>[m(s(L),{modelValue:l.value.role,"onUpdate:modelValue":g[0]||(g[0]=C=>l.value.role=C),label:s(a)("Choose a role"),choices:x.value,"choices-per-line":2},null,8,["modelValue","label","choices"])]),_:1}),m(D,{cols:"5"},{default:_(()=>[m(z,{color:"primary",class:"mt-11 ml-4 rounded-lg"},{default:_(()=>[w("h3",W,h(e.value),1),w("p",X,h(f.value),1),m(J,{color:"white",class:"float-right",size:"large",icon:"mdi-help-circle-outline"})]),_:1})]),_:1})]),_:1})]),_:1},512))}},Y={class:"m-label"},Z={class:"m-label"},ee={class:"m-label"},be={__name:"AccountGeneralForm",props:{modelValue:{type:Object,default:null},editing:{type:Boolean,default:!1}},setup(V,{expose:y}){const{$gettext:d}=S(),a=V,c=b(),n=b({}),l=v(()=>a.modelValue),p=v(()=>l.value.role==="SimpleUsers"?d("Enter an email address"):d("Enter a simple username or an email address")),e=v(()=>l.value.role==="SimpleUsers"?"email":"text");function f(){l.value.role!="SuperAdmins"&&l.value.username.indexOf("@")!==-1&&(l.value.mailbox.full_address=l.value.username,l.value.mailbox.message_limit=null)}return y({vFormRef:c,formErrors:n}),(x,r)=>(A(),F($,{ref_key:"vFormRef",ref:c},{default:_(()=>[w("label",Y,h(s(d)("Username")),1),m(q,{ref:"username",modelValue:l.value.username,"onUpdate:modelValue":[r[0]||(r[0]=o=>l.value.username=o),f],placeholder:p.value,type:e.value,rules:e.value==="email"?[s(U).required,s(U).email]:[s(U).required],role:l.value.role,"error-msg":n.value.value?n.value.value.username:[]},null,8,["modelValue","placeholder","type","rules","role","error-msg"]),w("label",Z,h(s(d)("First name")),1),m(R,{modelValue:l.value.first_name,"onUpdate:modelValue":r[1]||(r[1]=o=>l.value.first_name=o),autocomplete:"new-password",variant:"outlined",density:"compact"},null,8,["modelValue"]),w("label",ee,h(s(d)("Last name")),1),m(R,{modelValue:l.value.last_name,"onUpdate:modelValue":r[2]||(r[2]=o=>l.value.last_name=o),autocomplete:"new-password",variant:"outlined",density:"compact"},null,8,["modelValue"]),m(K,{ref:"passwordForm",modelValue:l.value,"onUpdate:modelValue":r[3]||(r[3]=o=>l.value=o),editing:V.editing,"form-errors":n.value},null,8,["modelValue","editing","form-errors"]),m(k,{modelValue:l.value.is_active,"onUpdate:modelValue":r[4]||(r[4]=o=>l.value.is_active=o),label:s(d)("Enabled"),density:"compact",color:"primary"},null,8,["modelValue","label"])]),_:1},512))}},le={class:"m-label"},ae={class:"m-label"},oe={__name:"AccountMailboxForm",props:{modelValue:{type:Object,default:null}},emits:["update:modelValue"],setup(V,{expose:y,emit:d}){const{$gettext:a}=S(),c=d,n=V,l=N(),p=b(),e=b({mailbox:{}});B(n.modelValue,t=>{t?(e.value={...t},e.value.role==="SimpleUsers"&&(e.value.mailbox||(e.value.mailbox={}),e.value.mailbox.full_address=e.value.username),e.value.mailbox.message_limit===""&&(e.value.mailbox.message_limit=null)):e.value={mailbox:{}}},{immediate:!0}),B(e,t=>{c("update:modelValue",t)},{deep:!0});const f=v(()=>{const t=e.value.mailbox.full_address;if(t&&t.indexOf("@")!==-1){const u=l.getDomainByName(t.split("@")[1]);if(u)return parseInt(u.default_mailbox_quota)}}),x=v(()=>{let t=a("Use domain default value");return f.value!==void 0&&(f.value===0?t+=` (${a("unlimited")})`:t+=` (${f.value} MB)`),t});function r(t){t&&delete e.value.mailbox.quota}function o(t){t===""&&delete e.value.mailbox.message_limit}return y({vFormRef:p}),(t,u)=>(A(),F($,{ref_key:"vFormRef",ref:p},{default:_(()=>[w("label",le,h(s(a)("Quota")),1),m(k,{modelValue:e.value.mailbox.use_domain_quota,"onUpdate:modelValue":[u[0]||(u[0]=i=>e.value.mailbox.use_domain_quota=i),r],label:x.value,color:"primary"},null,8,["modelValue","label"]),e.value.mailbox.use_domain_quota?M("",!0):(A(),F(R,{key:0,modelValue:e.value.mailbox.quota,"onUpdate:modelValue":u[1]||(u[1]=i=>e.value.mailbox.quota=i),placeholder:s(a)("Ex: 10MB. Leave empty for no limit"),hint:s(a)("Quota for this mailbox, can be expressed in KB, MB (default) or GB. Define a custom value or use domain's default one. Leave empty to define an unlimited value (not allowed for domain administrators)."),"persistent-hint":"",variant:"outlined",density:"compact"},null,8,["modelValue","placeholder","hint"])),w("label",ae,h(s(a)("Daily message sending limit")),1),m(R,{modelValue:e.value.mailbox.message_limit,"onUpdate:modelValue":[u[2]||(u[2]=i=>e.value.mailbox.message_limit=i),o],placeholder:s(a)("Leave empty for no limit"),hint:s(a)("Number of messages this mailbox can send per day. Leave empty for no limit."),"persistent-hint":"",variant:"outlined",density:"compact",rules:[s(U).numericOrNull]},null,8,["modelValue","placeholder","hint","rules"]),m(k,{modelValue:e.value.mailbox.is_send_only,"onUpdate:modelValue":u[3]||(u[3]=i=>e.value.mailbox.is_send_only=i),label:s(a)("Send only account"),density:"compact",color:"primary"},null,8,["modelValue","label"])]),_:1},512))}},_e=O(oe,[["__scopeId","data-v-be9c3cb0"]]),Ve={__name:"AccountAliasForm",props:{modelValue:{type:Object,default:null}},setup(V,{expose:y}){const{$gettext:d}=S(),a=V,c=v(()=>a.modelValue),n=b(""),l=b(),p=b(),e=b(!1),f=b([]);async function x(){if(f.value=[],e.value=!0,c.value.aliases.indexOf(n.value)!==-1){f.value=[d("Alias already added")],n.value="",e.value=!1;return}try{await T.validate({aliases:[n.value],mailbox:c.value.mailbox}),c.value.aliases.push(n.value),n.value="",p.value.resetValidation()}catch(o){o.response.data.aliases?o.response.data.aliases:o.response.data.non_field_errors&&o.response.data.non_field_errors}finally{e.value=!1}}function r(o){c.value.aliases.splice(o,1)}return y({vFormRef:p}),(o,t)=>(A(),F($,{ref_key:"vFormRef",ref:p},{default:_(()=>[m(s(q),{ref_key:"aliasField",ref:l,modelValue:n.value,"onUpdate:modelValue":t[0]||(t[0]=u=>n.value=u),placeholder:s(d)("Start typing a name here..."),hint:s(d)("Alias(es) of this mailbox. To create a catchall alias, just enter the domain name (@domain.tld)."),"persistent-hint":"",loading:e.value,"error-msg":f.value,onDomainSelected:x},null,8,["modelValue","placeholder","hint","loading","error-msg"]),(A(!0),j(Q,null,G(c.value.aliases,(u,i)=>(A(),F(P,{key:i,class:"mr-2 mt-2",closable:"","onClick:close":g=>r(i)},{default:_(()=>[I(h(u),1)]),_:2},1032,["onClick:close"]))),128))]),_:1},512))}};export{_e as A,ve as _,be as a,Ve as b};
