import{_ as I,b as G,a0 as z,L,M,G as m,i as B,k as C,R as n,a as u,w as i,N as R,o as s,S as U,t as h,J as c,V as g,c as p,Q as W,U as j,e as D}from"./index-Bbkf9DIc.js";import{p as y}from"./parameters-0JGAlobG.js";import{V as J,a as O}from"./VToolbar-BMyNQ6K-.js";import{V as Q,a as $,b as q,c as H}from"./VTabs-DXxJe3KI.js";import{g as K}from"./index-CDn75bM3.js";import{V as X}from"./VContainer-D7EM81q4.js";import{c as Y,a as Z}from"./VCard-DLgKmdoO.js";import{V as ee}from"./VSwitch-MOiUeFZQ.js";import{V as te}from"./VSelect-0_bFDN-s.js";import{V as ae}from"./VTextField-Djz_9Wz9.js";import"./tag-BgJ4tZGv.js";import"./VProgressCircular-o4TPEeLK.js";import"./forwardRefs-zpUiuLw8.js";import"./ssrBoot-C8G7_1W2.js";import"./dimensions-CxFA8Z4w.js";import"./VAvatar-CcSwNzJ2.js";import"./VWindowItem-D5SUtcL1.js";import"./VChip-DoOT6ijG.js";import"./VMenu-pbjiSmmM.js";/* empty css              */const le={key:0},oe={class:"m-label"},se={__name:"ParametersView",setup(re){const{$gettext:_}=G(),w=z(),N=L(),f=R(),F=M(),v=m(0),V=m([]),r=m({}),d=m({}),k=m(""),b=m([]),x=B(()=>V.value.filter(l=>T(l))),P=B(()=>_("Settings: "+k.value));function S(l){y.getApplicationStructure(l).then(t=>{V.value=t.data}),y.getApplication(l).then(t=>{r.value=t.data.params,k.value=t.data.label})}function T(l){if(l.display==="")return!0;let t=!0;return l.display.split("&").forEach(a=>{let[e,o]=a.split("=");(o==="true"||o==="false")&&(o=!!o),t&=r.value[e]===o}),t}function E(l){return l.filter(t=>T(t))}async function A(){d.value={},b.value=[],y.saveApplication(f.params.app,r.value).then(()=>{w.displayNotification({msg:_("Parameters updated")}),N.fetchNotifications(),f.params.app==="imap_migration"&&(F.imapMigrationEnabled=r.value.enabled_imapmigration)}).catch(l=>{w.displayNotification({msg:_("Could not save parameters"),type:"error"}),d.value=l.response.data,Object.keys(d.value).forEach(t=>{for(let a=0;a<V.value.length;a++)V.value[a].parameters.filter(o=>o.name===t).length>0&&b.value.push(a)})})}return C(f,l=>{S(l.params.app)}),C(r,()=>{b.value=[]}),S(f.params.app),(l,t)=>(s(),n("div",null,[u(J,{flat:""},{default:i(()=>[u(O,null,{default:i(()=>[U(h(P.value),1)]),_:1})]),_:1}),u(Q,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=a=>v.value=a),"bg-color":"white"},{default:i(()=>[(s(!0),n(c,null,g(x.value,(a,e)=>(s(),p(q,{key:e,color:"primary",class:W(b.value.includes(e)?"error_tab":"")},{default:i(()=>[U(h(a.label),1)]),_:2},1032,["class"]))),128))]),_:1},8,["modelValue"]),u($,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=a=>v.value=a)},{default:i(()=>[(s(!0),n(c,null,g(x.value,a=>(s(),p(H,{key:a.label},{default:i(()=>[u(X,{fluid:"",class:"pa-0"},{default:i(()=>[u(Y,null,{default:i(()=>[u(Z,null,{default:i(()=>[(s(!0),n(c,null,g(E(a.parameters),e=>(s(),n("div",{key:e.name,class:"my-4"},[e.widget==="SeparatorField"?(s(),n("h2",le,h(e.label),1)):e.widget==="BooleanField"?(s(),n(c,{key:1},[e.widget==="BooleanField"?(s(),p(ee,{key:0,modelValue:r.value[e.name],"onUpdate:modelValue":o=>r.value[e.name]=o,label:e.label,hint:e.help_text,error:d.value[e.name]!==void 0,color:"primary",density:"compact","error-messages":d.value[e.name],"persistent-hint":""},null,8,["modelValue","onUpdate:modelValue","label","hint","error","error-messages"])):j("",!0)],64)):(s(),n(c,{key:2},[D("label",oe,h(e.label),1),e.widget==="ChoiceField"?(s(),p(te,{key:0,modelValue:r.value[e.name],"onUpdate:modelValue":o=>r.value[e.name]=o,items:e.choices,"item-title":"text",hint:e.help_text,"persistent-hint":"",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","items","hint"])):(s(),p(ae,{key:1,modelValue:r.value[e.name],"onUpdate:modelValue":o=>r.value[e.name]=o,hint:e.help_text,"persistent-hint":"",error:d.value[e.name]!==void 0,"error-messages":d.value[e.name],type:e.widget==="PasswordField"?"password":"text",density:"compact",variant:"outlined"},null,8,["modelValue","onUpdate:modelValue","hint","error","error-messages","type"]))],64))]))),128))]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128))]),_:1},8,["modelValue"]),u(K,{icon:"mdi-content-save",class:"ma-5",position:"fixed",location:"bottom right",color:"green",size:"large",onClick:A})]))}},Be=I(se,[["__scopeId","data-v-6d2695c9"]]);export{Be as default};
