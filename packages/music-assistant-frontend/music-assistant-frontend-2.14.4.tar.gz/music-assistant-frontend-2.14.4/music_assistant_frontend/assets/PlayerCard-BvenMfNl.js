import{x as P,c as z,R as b,S as t,at as oe,$ as ae,U as p,au as se,D as ie,aW as V,b9 as k,a4 as d,ay as L,b7 as R,aw as A,a2 as T,a8 as te,b2 as x,Q as le,a1 as ne,a9 as h,Z as c,X as $,ar as E,a0 as n,B as g,an as S,W as q,ab as f,b1 as N,ao as U,Y as re,G as de,b6 as ue,ax as B,a7 as pe,as as me,am as I,a5 as ye,b5 as ce,a$ as ve,bf as _e,aX as fe,V as he,a3 as be}from"./index-NjNzsJZz.js";import{M as ge}from"./MediaItemThumb-Et_an17N.js";import{B as M}from"./Button-C4q1f0oo.js";import{_ as O}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{V as we}from"./VSlider-C-UASzEy.js";import{V as Ce}from"./VCheckbox-CXmjKPs1.js";const ke={props:{width:String,height:String,style:String,allowWheel:Boolean},emits:["update:model-value"],setup(s,l){const u=P(!0),i=z(()=>({class:"player-volume",hideDetails:!0,trackSize:2,thumbSize:u.value?0:10,step:2,elevation:0,style:`width: ${s.width}; height:${s.height}; display: inline-grid; ${s.style}`})),C=z(()=>({...i.value,...l}));return{isThumbHidden:u,playerVolumeProps:C,onWheel:({deltaY:y})=>{if(!s.allowWheel)return;const m=C.value.step,a=l.attrs["model-value"],r=y<0?m:-m;l.emit("update:model-value",a+r)}}}};function Se(s,l,u,i,C,e){return t(),b(we,ie(i.playerVolumeProps,{onTouchstart:l[0]||(l[0]=y=>i.isThumbHidden=!1),onTouchend:l[1]||(l[1]=y=>i.isThumbHidden=!0),onMouseenter:l[2]||(l[2]=y=>i.isThumbHidden=!1),onMouseleave:l[3]||(l[3]=y=>i.isThumbHidden=!0),onWheel:V(i.onWheel,["prevent"]),onEnd:l[4]||(l[4]=y=>s.$emit("update:model-value",y))}),oe({_:2},[ae(s.$slots,(y,m)=>({name:m,fn:p(()=>[se(s.$slots,m,{},void 0,!0)])}))]),1040,["onWheel"])}const ee=O(ke,[["render",Se],["__scopeId","data-v-af51e13c"]]),Ve=(s,l)=>{const u=[];(s==null?void 0:s.power_control)!=k&&u.push({label:s.powered?"power_off_player":"power_on_player",labelArgs:[],action:()=>{d.playerCommandPowerToggle(s.player_id)},icon:"mdi-power"}),((s==null?void 0:s.state)=="playing"||(s==null?void 0:s.state)=="paused")&&u.push({label:"stop_playback",labelArgs:[],action:()=>{d.playerCommandStop(s.player_id)},icon:"mdi-stop"});const i=Object.values(d.players).filter(e=>e.player_id!=s.player_id&&e.available&&e.enabled&&(e.can_group_with.includes(s.provider)||e.can_group_with.includes(s.player_id))&&e.supported_features.includes(L.SET_MEMBERS)&&!e.synced_to);s.supported_features.includes(L.SET_MEMBERS)&&!s.synced_to&&s.type==R.PLAYER&&s.group_childs.length==0&&i.length>0&&u.push({label:"sync_player_with",labelArgs:[],icon:"mdi-link-variant",subItems:i.map(e=>({label:e.display_name,labelArgs:[],action:()=>{d.playerCommandGroup(s.player_id,e.player_id)}})).sort((e,y)=>{var m;return e.label.toUpperCase()>((m=y.label)==null?void 0:m.toUpperCase())?1:-1})}),l&&u.push({label:l.shuffle_enabled?"shuffle_disable":"shuffle_enable",labelArgs:[],action:()=>{d.queueCommandShuffleToggle(l.queue_id)},icon:l.shuffle_enabled?"mdi-shuffle-disabled":"mdi-shuffle"}),l&&u.push({label:"select_repeat_mode",labelArgs:[],subItems:[{label:"repeat_mode.off",labelArgs:[],action:()=>{d.queueCommandRepeat(l.queue_id,A.OFF)},selected:l.repeat_mode==A.OFF},{label:"repeat_mode.all",labelArgs:[],action:()=>{d.queueCommandRepeat(l.queue_id,A.ALL)},selected:l.repeat_mode==A.ALL},{label:"repeat_mode.one",labelArgs:[],action:()=>{d.queueCommandRepeat(l.queue_id,A.ONE)},selected:l.repeat_mode==A.ONE}],icon:"mdi-repeat"}),l!=null&&l.items&&u.push({label:"transfer_queue",icon:"mdi-swap-horizontal",subItems:Object.values(d.players).filter(e=>e.player_id!=l.queue_id&&e.player_id!=s.player_id&&e.available&&e.enabled&&!e.synced_to).map(e=>({label:e.display_name,labelArgs:[],action:()=>{d.queueCommandTransfer(l.queue_id,e.player_id),T.activePlayerId=e.player_id}})).sort((e,y)=>{var m;return e.label.toUpperCase()>((m=y.label)==null?void 0:m.toUpperCase())?1:-1})}),l!=null&&l.items&&u.push({label:"queue_clear",labelArgs:[],action:()=>{d.queueCommandClear(l.queue_id)},icon:"mdi-cancel"});const C=s.source_list.filter(e=>!e.passive||e.id==s.active_source);return s.active_source!=s.player_id&&C.push({id:s.player_id,name:te("music_assistant_source"),passive:!1,can_play_pause:!0,can_seek:!0,can_next_previous:!0}),!s.synced_to&&C.length>0&&u.push({label:"select_source",labelArgs:[],icon:"mdi-import",subItems:C.map(e=>({label:e.name,labelArgs:[],disabled:e.id==s.active_source,selected:e.id==s.active_source,action:()=>{d.playerCommandGroupSelectSource(s.player_id,e.id)}})).sort((e,y)=>{var m;return e.label.toUpperCase()>((m=y.label)==null?void 0:m.toUpperCase())?1:-1})}),l&&"dont_stop_the_music_enabled"in l&&u.push({label:l.dont_stop_the_music_enabled?"dont_stop_the_music_disable":"dont_stop_the_music_enable",labelArgs:[],action:()=>{d.queueCommandDontStopTheMusicToggle(l.queue_id)},icon:"mdi-all-inclusive"}),u.push({label:"open_player_settings",labelArgs:[],action:()=>{T.showFullscreenPlayer=!1,T.showPlayersMenu=!1,x.push(`/settings/editplayer/${s.player_id}`)},icon:"mdi-cog-outline"}),s.type!==R.GROUP&&u.push({label:"open_dsp_settings",labelArgs:[],action:()=>{T.showFullscreenPlayer=!1,T.showPlayersMenu=!1,x.push(`/settings/editplayer/${s.player_id}/dsp`)},icon:"mdi-equalizer"}),u},Te={key:1,class:"text-caption volumecaption"},Ae={key:0,class:"text-caption volumecaption"},Me=le({__name:"VolumeControl",props:{player:{},showSyncControls:{type:Boolean},showSubPlayers:{type:Boolean},showHeadingRow:{type:Boolean},showVolumeControl:{type:Boolean},allowWheel:{type:Boolean}},setup(s){const l=s,u=P([]),i=P([]),C=P(void 0),e=z(()=>l.player.group_childs.length>0),y=function(a){var o,_;const r=[];for(const v of a.group_childs){const w=(o=d)==null?void 0:o.players[v];w&&w.volume_control!=k&&w&&w.available&&!r.includes(w)&&r.push(w)}if(l.showSyncControls&&a.supported_features.includes(L.SET_MEMBERS))for(const v of Object.values((_=d)==null?void 0:_.players))v.player_id!=a.player_id&&(!a.can_group_with.includes(v.player_id)&&!a.can_group_with.includes(v.provider)||v.available&&(v.active_group&&v.active_group!=a.player_id||v.active_source&&v.state==B.PLAYING&&![a.player_id,v.player_id].includes(v.active_source)||r.includes(v)||r.push(v)));return r.sort((v,w)=>v.display_name.toUpperCase()>w.display_name.toUpperCase()?1:-1),r},m=async function(a,r){const o=l.player.player_id;r?(i.value.includes(a)&&(i.value=i.value.filter(_=>_!=a)),u.value.includes(a)||u.value.push(a),d.players[o].group_childs.push(a)):(u.value.includes(a)&&(u.value=u.value.filter(_=>_!=a)),i.value.includes(a)||i.value.push(a),d.players[o].group_childs=d.players[o].group_childs.filter(_=>_!=a)),C.value!=null&&clearTimeout(C.value),C.value=setTimeout(async()=>{i.value.length>0&&d.playerCommandUnGroupMany(i.value).catch(async()=>{d.players[o]=await d.getPlayer(o)}).finally(()=>{i.value=[]}),u.value.length>0&&d.playerCommandGroupMany(o,u.value).catch(async()=>{d.players[o]=await d.getPlayer(o)}).finally(()=>{u.value=[]})},1e3)};return(a,r)=>(t(),b(ne,{style:{overflow:"hidden",padding:"0"},lines:"two"},{default:p(()=>[a.showHeadingRow?(t(),b($,{key:0,class:"volumesliderrow heading",link:!1,style:E(a.player.powered==!1?"opacity: 0.6":"opacity: 1")},{prepend:p(()=>[g(S,{size:25,icon:a.player.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[q("h5",null,f(n(N)(a.player,27)),1)]),append:p(()=>[a.player.power_control!=n(k)?(t(),b(M,{key:0,class:"powerbtn",variant:"icon",onClick:r[0]||(r[0]=V(o=>n(d).playerCommandPowerToggle(a.player.player_id),["stop"]))},{default:p(()=>[g(S,{size:25,icon:"mdi-power"})]),_:1})):h("",!0)]),_:1},8,["style"])):h("",!0),a.showVolumeControl&&(a.player.volume_control!=n(k)||a.player.group_childs.length)?(t(),b($,{key:1,class:"volumesliderrow",link:!1,style:E(a.player.powered==!1?"opacity: 0.35":"opacity: 0.75")},{prepend:p(()=>[g(M,{icon:"",style:{height:"25px"},disabled:a.player.type==n(R).GROUP||a.player.group_childs.length>0||a.player.mute_control==n(k),onClick:r[1]||(r[1]=V(o=>n(d).playerCommandMuteToggle(a.player.player_id),["stop"]))},{default:p(()=>[g(S,{size:25,icon:a.player.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:1},8,["disabled"])]),default:p(()=>[a.player.volume_control!=n(k)||a.player.group_childs.length?(t(),b(ee,{key:0,color:"secondary",width:"100%","is-powered":a.player.powered!=!1,disabled:!a.player.available,"model-value":Math.round(a.player.group_childs.length?a.player.group_volume:a.player.volume_level||0),onClick:r[2]||(r[2]=V(()=>{},["stop"])),"onUpdate:modelValue":r[3]||(r[3]=o=>a.player.group_childs.length>0?n(d).playerCommandGroupVolume(a.player.player_id,o):n(d).playerCommandVolumeSet(a.player.player_id,o))},null,8,["is-powered","disabled","model-value"])):h("",!0)]),append:p(()=>[e.value&&!a.showSubPlayers?(t(),b(S,{key:0,class:"expandbtn"},{default:p(()=>r[7]||(r[7]=[U(" mdi-chevron-down ")])),_:1})):(t(),c("div",Te,f(Math.round(a.player.group_childs.length?a.player.group_volume:a.player.volume_level||0)),1))]),_:1},8,["style"])):h("",!0),a.showSubPlayers&&(a.player.group_childs.length>0||a.showSyncControls)&&y(a.player).length>0?(t(),c("div",{key:2,onClick:r[6]||(r[6]=V(()=>{},["stop"]))},[g(re,{style:{"margin-top":"10px","margin-bottom":"15px"}}),(t(!0),c(de,null,ae(y(a.player),o=>(t(),c("div",{key:o.player_id},[g($,{class:"volumesliderrow",link:!1,style:E(o.powered!=!1||a.showSyncControls?"opacity: 0.75":"opacity: 0.4"),onClick:r[4]||(r[4]=V(()=>{},["stop"]))},{prepend:p(()=>[g(S,{size:30,icon:o.icon,style:{"margin-left":"6px",opacity:"0.6"}},null,8,["icon"])]),default:p(()=>[q("h6",null,f(n(ue)(o.display_name,27)),1)]),append:p(()=>[a.showSyncControls?(t(),b(Ce,{key:0,ripple:!1,disabled:o.player_id==a.player.player_id,"model-value":a.player.group_childs.includes(o.player_id)||o.player_id==a.player.player_id,size:"22",class:"checkbox","onUpdate:modelValue":_=>m(o.player_id,_)},null,8,["disabled","model-value","onUpdate:modelValue"])):h("",!0)]),_:2},1032,["style"]),o.volume_control!=n(k)?(t(),b($,{key:0,class:"volumesliderrow",link:!1,style:E(o.powered==!1?"opacity: 0.4":"opacity: 0.75"),onClick:r[5]||(r[5]=V(()=>{},["stop"]))},{prepend:p(()=>[g(M,{icon:"",disabled:!o.available||o.mute_control==n(k),style:{height:"25px"},onClick:_=>n(d).playerCommandMuteToggle(o.player_id)},{default:p(()=>[g(S,{size:25,icon:o.volume_muted?"mdi-volume-mute":"mdi-volume-medium"},null,8,["icon"])]),_:2},1032,["disabled","onClick"])]),default:p(()=>[o.volume_control!=n(k)?(t(),b(ee,{key:0,color:"secondary",width:"100%","is-powered":o.powered!=!1,disabled:!o.available,"allow-wheel":a.allowWheel,"model-value":Math.round(o.volume_level||0),"onUpdate:modelValue":_=>n(d).playerCommandVolumeSet(o.player_id,_)},null,8,["is-powered","disabled","allow-wheel","model-value","onUpdate:modelValue"])):h("",!0)]),append:p(()=>[o.volume_control!=n(k)?(t(),c("div",Ae,f(o.volume_level),1)):h("",!0)]),_:2},1032,["style"])):h("",!0),r[8]||(r[8]=q("div",{style:{height:"14px"}},null,-1))]))),128))])):h("",!0)]),_:1}))}}),$e=O(Me,[["__scopeId","data-v-a2a4ac06"]]),Be={class:"player-media-thumb"},qe={key:1},ze={key:2,class:"icon-thumb"},Ee={key:0,style:{"margin-bottom":"3px"}},Pe={key:0},Ue={key:1},Re={key:1,style:{"margin-bottom":"3px"}},Ie={key:0,style:{"font-size":"0.85rem","font-weight":"500","white-space":"nowrap"}},Le={key:0},Ne={key:0},Oe={key:1},We={key:2},De={class:"v-list-item-subtitle",style:{"white-space":"nowrap"}},Ge={key:0},Ye={key:1},Fe={key:2},He={key:3},Xe={key:4},je={key:5},Ke={key:6},Ze=le({__name:"PlayerCard",props:{player:{},showVolumeControl:{type:Boolean},showMenuButton:{type:Boolean},showSubPlayers:{type:Boolean},showSyncControls:{type:Boolean}},setup(s){const l=s,u=z(()=>{if(l.player&&l.player.active_source&&l.player.active_source in d.queues)return d.queues[l.player.active_source];if(l.player&&!l.player.active_source&&l.player.player_id in d.queues)return d.queues[l.player.player_id]}),i=z(()=>{if(u.value&&u.value.active)return u.value.current_item}),C=function(e){be.emit("contextmenu",{items:Ve(l.player,u.value),posX:e.clientX,posY:e.clientY})};return(e,y)=>(t(),b(pe,{flat:"",class:me(["panel-item",{"panel-item-selected":e.player.player_id==n(T).activePlayerId,"panel-item-idle":e.player.state==n(B).IDLE,"panel-item-off":e.player.powered==!1}]),ripple:!1,disabled:!e.player.available},{default:p(()=>[g($,{class:"panel-item-details",flat:"",ripple:!1},{prepend:p(()=>{var m,a,r,o;return[q("div",Be,[e.player.powered!=!1&&((m=i.value)!=null&&m.media_item)||(a=i.value)!=null&&a.image?(t(),b(ge,{key:0,class:"media-thumb",size:"55",item:((r=i.value)==null?void 0:r.media_item)||i.value,fallback:n(fe)},null,8,["item","fallback"])):e.player.powered!=!1&&!u.value&&((o=e.player.current_media)!=null&&o.image_url)?(t(),c("div",qe,[g(he,{class:"media-thumb",size:"55",src:e.player.current_media.image_url},null,8,["src"])])):(t(),c("div",ze,[g(S,{size:"35",icon:e.player.type==n(R).PLAYER&&e.player.group_childs.length?"mdi-speaker-multiple":e.player.icon,style:{display:"table-cell",opacity:"0.8"}},null,8,["icon"])]))])]}),title:p(()=>[n(_e).player_id===e.player.player_id?(t(),c("div",Ee,[e.player.display_name=="This Device"?(t(),c("span",Pe,f(e.$t("this_device")),1)):(t(),c("span",Ue,f(n(N)(e.player,27)),1)),g(S,{size:"20",class:"pl-2",icon:n(T).deviceType=="phone"?"mdi-cellphone":"mdi-monitor"},null,8,["icon"])])):(t(),c("div",Re,f(n(N)(e.player,27)),1))]),subtitle:p(()=>{var m,a,r,o,_,v,w;return[e.player.powered!=!1?(t(),c("div",Ie,[(m=i.value)!=null&&m.media_item?(t(),c("div",Le,[U(f((a=i.value)==null?void 0:a.media_item.name)+" ",1),"version"in((r=i.value)==null?void 0:r.media_item)&&((o=i.value)!=null&&o.media_item.version)?(t(),c("span",Ne,"("+f((_=i.value)==null?void 0:_.media_item.version)+")",1)):h("",!0)])):i.value?(t(),c("div",Oe,f((v=i.value)==null?void 0:v.name),1)):!u.value&&((w=e.player.current_media)!=null&&w.title)?(t(),c("div",We,f(e.player.current_media.title),1)):h("",!0)])):h("",!0)]}),default:p(()=>{var m,a,r,o,_,v,w,W,D,G,Y,F,H,X,j,K,Z,J,Q;return[q("div",De,[e.player.powered==!1?(t(),c("div",Ge,f(e.$t("off")),1)):(m=i.value)!=null&&m.media_item&&((r=(a=i.value)==null?void 0:a.media_item)==null?void 0:r.media_type)==n(ye).TRACK&&"album"in((o=i.value)==null?void 0:o.media_item)&&((_=i.value)!=null&&_.media_item.album)?(t(),c("div",Ye,f(n(ce)((v=i.value)==null?void 0:v.media_item.artists))+" â€¢ "+f((w=i.value)==null?void 0:w.media_item.album.name),1)):(W=i.value)!=null&&W.media_item&&"artists"in((D=i.value)==null?void 0:D.media_item)&&((G=i.value)==null?void 0:G.media_item.artists.length)>0?(t(),c("div",Fe,f((Y=i.value)==null?void 0:Y.media_item.artists[0].name),1)):(H=(F=i.value)==null?void 0:F.streamdetails)!=null&&H.stream_title?(t(),c("div",He,f((j=(X=i.value)==null?void 0:X.streamdetails)==null?void 0:j.stream_title),1)):(Z=(K=i.value)==null?void 0:K.media_item)!=null&&Z.metadata.description?(t(),c("div",Xe,f((J=i.value)==null?void 0:J.media_item.metadata.description),1)):!u.value&&e.player.active_source?(t(),c("div",je,f(e.$t("external_source_active",[n(ve)(e.player)])),1)):((Q=u.value)==null?void 0:Q.items)==0?(t(),c("div",Ke,f(e.$t("queue_empty")),1)):h("",!0)])]}),append:p(()=>{var m;return[e.player.state==n(B).PAUSED||e.player.state==n(B).PLAYING||(m=u.value)!=null&&m.items?(t(),b(M,{key:0,variant:"icon",class:"player-command-btn",onClick:y[0]||(y[0]=V(a=>{n(d).playerCommandPlayPause(e.player.player_id),n(T).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[g(S,{size:n(I)({breakpoint:"phone"})?"30":"32",icon:e.player.state==n(B).PLAYING?"mdi-pause":"mdi-play"},null,8,["size","icon"])]),_:1})):h("",!0),e.player.power_control!=n(k)?(t(),b(M,{key:1,variant:"icon",class:"player-command-btn",onClick:y[1]||(y[1]=V(a=>{n(d).playerCommandPowerToggle(e.player.player_id),n(T).activePlayerId=e.player.player_id},["stop"]))},{default:p(()=>[g(S,{size:n(I)({breakpoint:"phone"})?"30":"32"},{default:p(()=>y[2]||(y[2]=[U("mdi-power")])),_:1},8,["size"])]),_:1})):h("",!0),e.showMenuButton?(t(),b(M,{key:2,variant:"icon",class:"player-command-btn",style:{"margin-right":"-5px"},onClick:V(C,["stop"])},{default:p(()=>[g(S,{size:n(I)({breakpoint:"phone"})?"30":"32"},{default:p(()=>y[3]||(y[3]=[U("mdi-dots-vertical")])),_:1},8,["size"])]),_:1})):h("",!0)]}),_:1}),e.showVolumeControl?(t(),b($e,{key:0,player:e.player,"show-sync-controls":e.showSyncControls,"show-heading-row":!1,"show-sub-players":e.showSubPlayers,"show-volume-control":e.player.powered!=!1,"allow-wheel":!1},null,8,["player","show-sync-controls","show-sub-players","show-volume-control"])):h("",!0)]),_:1},8,["class","disabled"]))}}),oa=O(Ze,[["__scopeId","data-v-eec251ab"]]);export{ee as P,$e as V,oa as a,Ve as g};
